/**
 * Tools Page Optimizations - Surprise Granite
 * Responsive iframe handling for visualizer tools
 * Mobile-first approach with iOS/Android optimizations
 */

/* ================================================================
   CSS VARIABLES FOR TOOLS PAGES
   ================================================================ */
:root {
  --tools-navbar-height: 72px;
  --tools-navbar-height-mobile: 56px;
  --tools-navbar-height-small: 48px;
  --tools-safe-bottom: env(safe-area-inset-bottom, 0px);
  --tools-safe-top: env(safe-area-inset-top, 0px);
}

/* ================================================================
   BASE IFRAME CONTAINER STYLES
   All visualizer embed containers
   ================================================================ */
.visualizer-embed,
.roomvo-modal_embed,
.iframe-container,
.tool-embed,
.msi-embed-container,
[class*="embed"] iframe {
  width: 100%;
  max-width: 100%;
  position: relative;
  overflow: hidden;
}

/* Base iframe styles */
.visualizer-embed iframe,
.roomvo-modal_embed iframe,
.iframe-container iframe,
.tool-embed iframe,
.new-msi-embed,
iframe[title*="Visualizer"],
iframe[title*="Designer"],
iframe[title*="Room"] {
  width: 100% !important;
  max-width: 100% !important;
  border: none !important;
  display: block;
}

/* ================================================================
   DESKTOP STYLES (1024px and up)
   ================================================================ */
@media (min-width: 1024px) {
  .visualizer-embed,
  .roomvo-modal_embed,
  .tool-embed {
    min-height: 800px;
    height: calc(100vh - var(--tools-navbar-height) - 100px);
    max-height: 900px;
    margin: 0 auto;
    border-radius: 12px;
    box-shadow: 0 4px 20px rgba(0, 0, 0, 0.08);
  }

  .visualizer-embed iframe,
  .roomvo-modal_embed iframe,
  .tool-embed iframe,
  .new-msi-embed {
    min-height: 800px !important;
    height: 100% !important;
    border-radius: 12px;
  }

  .iframe-container {
    max-width: 1400px;
    margin: 0 auto;
    padding: 0 24px;
  }

  .iframe-container iframe {
    min-height: 800px !important;
    height: calc(100vh - 200px) !important;
    max-height: 900px;
    border-radius: 12px;
    box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
  }

  /* Roomvo specific - tends to need more height */
  .roomvo-modal_embed {
    min-height: 850px;
  }

  .roomvo-modal_embed iframe {
    min-height: 850px !important;
  }
}

/* ================================================================
   TABLET STYLES (768px - 1023px)
   ================================================================ */
@media (min-width: 768px) and (max-width: 1023px) {
  .visualizer-embed,
  .roomvo-modal_embed,
  .tool-embed,
  .iframe-container {
    min-height: 700px;
    height: calc(100vh - var(--tools-navbar-height) - 40px);
    padding: 0 16px;
  }

  .visualizer-embed iframe,
  .roomvo-modal_embed iframe,
  .tool-embed iframe,
  .iframe-container iframe,
  .new-msi-embed {
    min-height: 700px !important;
    height: 100% !important;
    border-radius: 8px;
  }

  /* Reduce page chrome on tablet */
  .section_header54,
  .padding-section-large {
    padding-top: 24px !important;
    padding-bottom: 24px !important;
  }

  .hero-section {
    padding: 24px 16px !important;
    min-height: auto !important;
  }
}

/* ================================================================
   MOBILE STYLES (up to 767px)
   ================================================================ */
@media (max-width: 767px) {
  /* Full-screen iframe approach */
  .visualizer-embed,
  .roomvo-modal_embed,
  .tool-embed {
    position: fixed !important;
    top: var(--tools-navbar-height-mobile) !important;
    left: 0 !important;
    right: 0 !important;
    bottom: 0 !important;
    width: 100vw !important;
    max-width: 100vw !important;
    height: calc(100vh - var(--tools-navbar-height-mobile)) !important;
    min-height: calc(100vh - var(--tools-navbar-height-mobile)) !important;
    margin: 0 !important;
    padding: 0 !important;
    z-index: 100;
    overflow: hidden;
    border-radius: 0 !important;
  }

  .visualizer-embed iframe,
  .roomvo-modal_embed iframe,
  .tool-embed iframe,
  .new-msi-embed {
    position: absolute !important;
    top: 0 !important;
    left: 0 !important;
    width: 100% !important;
    height: 100% !important;
    min-height: calc(100vh - var(--tools-navbar-height-mobile)) !important;
    border: none !important;
    border-radius: 0 !important;
  }

  /* iframe-container (MSI tools) */
  .iframe-container {
    position: fixed !important;
    top: var(--tools-navbar-height-mobile) !important;
    left: 0 !important;
    right: 0 !important;
    bottom: 0 !important;
    width: 100vw !important;
    max-width: 100vw !important;
    height: calc(100vh - var(--tools-navbar-height-mobile)) !important;
    margin: 0 !important;
    padding: 0 !important;
    z-index: 100;
  }

  .iframe-container iframe,
  .new-msi-embed {
    width: 100% !important;
    height: 100% !important;
    min-height: calc(100vh - var(--tools-navbar-height-mobile)) !important;
    border: none !important;
  }

  /* Roomvo container parent */
  .roomvo-modal_component,
  .roomvo-modal_container {
    position: fixed !important;
    top: var(--tools-navbar-height-mobile) !important;
    left: 0 !important;
    right: 0 !important;
    bottom: 0 !important;
    width: 100% !important;
    height: calc(100vh - var(--tools-navbar-height-mobile)) !important;
    padding: 0 !important;
    margin: 0 !important;
  }

  /* Fix navbar for tools pages */
  .navbar-fixed_wrapper {
    position: fixed !important;
    top: 0 !important;
    left: 0 !important;
    right: 0 !important;
    z-index: 1000 !important;
    height: var(--tools-navbar-height-mobile) !important;
    min-height: var(--tools-navbar-height-mobile) !important;
    max-height: var(--tools-navbar-height-mobile) !important;
  }

  /* Hide unnecessary elements on mobile tools pages */
  .section_header54,
  .section_footer2,
  .footer-component,
  .footer5_component,
  footer,
  .hero-section,
  .hero-content,
  .padding-global,
  .spacer-small,
  .spacer-medium,
  .spacer-large,
  .mobile-sticky-cta,
  .fixed-footer_left-content {
    display: none !important;
  }

  /* Page wrapper adjustments */
  .page-wrapper {
    overflow: hidden !important;
    height: 100vh !important;
    padding: 0 !important;
    margin: 0 !important;
  }

  .main-wrapper {
    padding: 0 !important;
    margin: 0 !important;
    min-height: 100vh !important;
    height: 100vh !important;
  }

  main.main-wrapper {
    padding-top: var(--tools-navbar-height-mobile) !important;
    height: calc(100vh - var(--tools-navbar-height-mobile)) !important;
  }

  body {
    overflow: hidden !important;
    position: fixed !important;
    width: 100% !important;
    height: 100% !important;
  }

  /* Prevent horizontal scroll */
  html {
    overflow-x: hidden !important;
  }
}

/* ================================================================
   SMALL MOBILE (up to 480px)
   ================================================================ */
@media (max-width: 480px) {
  :root {
    --tools-navbar-height-mobile: var(--tools-navbar-height-small);
  }

  .visualizer-embed,
  .roomvo-modal_embed,
  .tool-embed,
  .iframe-container {
    top: var(--tools-navbar-height-small) !important;
    height: calc(100vh - var(--tools-navbar-height-small)) !important;
    min-height: calc(100vh - var(--tools-navbar-height-small)) !important;
  }

  .visualizer-embed iframe,
  .roomvo-modal_embed iframe,
  .tool-embed iframe,
  .iframe-container iframe,
  .new-msi-embed {
    min-height: calc(100vh - var(--tools-navbar-height-small)) !important;
  }

  .roomvo-modal_component,
  .roomvo-modal_container {
    top: var(--tools-navbar-height-small) !important;
    height: calc(100vh - var(--tools-navbar-height-small)) !important;
  }

  .navbar-fixed_wrapper {
    height: var(--tools-navbar-height-small) !important;
    min-height: var(--tools-navbar-height-small) !important;
    max-height: var(--tools-navbar-height-small) !important;
  }

  main.main-wrapper {
    padding-top: var(--tools-navbar-height-small) !important;
    height: calc(100vh - var(--tools-navbar-height-small)) !important;
  }
}

/* ================================================================
   LANDSCAPE MOBILE
   ================================================================ */
@media (max-width: 896px) and (orientation: landscape) {
  .visualizer-embed,
  .roomvo-modal_embed,
  .tool-embed,
  .iframe-container {
    top: 44px !important;
    height: calc(100vh - 44px) !important;
    min-height: calc(100vh - 44px) !important;
  }

  .navbar-fixed_wrapper {
    height: 44px !important;
    min-height: 44px !important;
    max-height: 44px !important;
  }

  .roomvo-modal_component,
  .roomvo-modal_container {
    top: 44px !important;
    height: calc(100vh - 44px) !important;
  }
}

/* ================================================================
   iOS SAFE AREA SUPPORT
   ================================================================ */
@supports (padding: max(0px)) {
  @media (max-width: 767px) {
    .visualizer-embed,
    .roomvo-modal_embed,
    .tool-embed,
    .iframe-container {
      padding-bottom: var(--tools-safe-bottom) !important;
    }

    /* Account for iPhone notch */
    .navbar-fixed_wrapper {
      padding-top: var(--tools-safe-top);
    }
  }
}

/* ================================================================
   INTERIOR DESIGN GALLERY SPECIFIC
   (Not iframe-based, gallery layout)
   ================================================================ */
@media (max-width: 767px) {
  /* Gallery page should scroll normally */
  body:has(.gallery-component),
  body:has(.lightbox-component) {
    overflow: auto !important;
    position: relative !important;
  }

  .page-wrapper:has(.gallery-component) {
    overflow: auto !important;
    height: auto !important;
  }

  .gallery-component {
    padding: 16px;
  }

  .gallery-item,
  .gallery-card {
    border-radius: 8px;
    overflow: hidden;
  }

  /* Lightbox fullscreen on mobile */
  .lightbox-component,
  .w-lightbox-backdrop {
    position: fixed !important;
    top: 0 !important;
    left: 0 !important;
    right: 0 !important;
    bottom: 0 !important;
    z-index: 9999 !important;
  }
}

/* ================================================================
   LOADING & ERROR STATES
   ================================================================ */
.visualizer-embed.loading,
.roomvo-modal_embed.loading,
.iframe-container.loading {
  background: linear-gradient(90deg, #f0f0f0 25%, #e8e8e8 50%, #f0f0f0 75%);
  background-size: 200% 100%;
  animation: shimmer 1.5s infinite;
}

@keyframes shimmer {
  0% { background-position: 200% 0; }
  100% { background-position: -200% 0; }
}

.visualizer-embed.error,
.roomvo-modal_embed.error,
.iframe-container.error {
  display: flex;
  align-items: center;
  justify-content: center;
  background: #f8f8f8;
  color: #666;
  font-size: 16px;
  text-align: center;
  padding: 40px;
}

.visualizer-embed.error::before,
.roomvo-modal_embed.error::before,
.iframe-container.error::before {
  content: "Unable to load visualizer. Please refresh the page.";
}

/* ================================================================
   TOUCH OPTIMIZATIONS
   ================================================================ */
@media (hover: none) and (pointer: coarse) {
  /* Prevent bounce/overscroll on iOS */
  .visualizer-embed,
  .roomvo-modal_embed,
  .tool-embed {
    -webkit-overflow-scrolling: touch;
    overscroll-behavior: contain;
  }

  /* Ensure iframe is touch-scrollable */
  .visualizer-embed iframe,
  .roomvo-modal_embed iframe,
  .iframe-container iframe {
    touch-action: pan-x pan-y;
  }
}

/* ================================================================
   PRINT STYLES
   ================================================================ */
@media print {
  .visualizer-embed,
  .roomvo-modal_embed,
  .iframe-container {
    display: none !important;
  }

  .page-wrapper::after {
    content: "This visualizer tool cannot be printed. Please visit surprisegranite.com/tools to use it.";
    display: block;
    padding: 40px;
    text-align: center;
    font-size: 16px;
  }
}

/* ================================================================
   ACCESSIBILITY
   ================================================================ */
@media (prefers-reduced-motion: reduce) {
  .visualizer-embed.loading,
  .roomvo-modal_embed.loading,
  .iframe-container.loading {
    animation: none;
  }
}

/* High contrast mode support */
@media (prefers-contrast: high) {
  .visualizer-embed iframe,
  .roomvo-modal_embed iframe,
  .iframe-container iframe {
    border: 2px solid #000 !important;
  }
}
