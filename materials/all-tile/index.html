<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <title>Premium Tile Collection | Porcelain, Ceramic & Mosaic Tile | Surprise Granite Arizona</title>
  <meta name="description" content="Shop 460+ premium tiles for kitchen backsplash, bathroom floors & walls. Porcelain, ceramic, marble & mosaic tiles from MSI & Bravo. Free estimates in Phoenix, Scottsdale, Glendale AZ.">
  <meta name="keywords" content="tile Phoenix AZ, porcelain tile Arizona, ceramic tile Scottsdale, bathroom tile Glendale, kitchen backsplash tile, mosaic tile, floor tile installation, wall tile, tile store near me">
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover">
  <meta name="robots" content="index, follow, max-image-preview:large">
  <meta name="author" content="Surprise Granite">
  <link rel="icon" href="/images/favicon.png" type="image/png">
  <link rel="canonical" href="https://www.surprisegranite.com/materials/all-tile/">

  <!-- Open Graph / Social -->
  <meta property="og:type" content="website">
  <meta property="og:title" content="Premium Tile Collection | Surprise Granite Arizona">
  <meta property="og:description" content="Shop 460+ premium porcelain, ceramic & mosaic tiles for kitchen and bathroom. Free estimates in Phoenix Metro Area.">
  <meta property="og:image" content="https://www.surprisegranite.com/images/tiles/tile-collection-hero.jpg">
  <meta property="og:url" content="https://www.surprisegranite.com/materials/all-tile/">
  <meta property="og:site_name" content="Surprise Granite">
  <meta property="og:locale" content="en_US">

  <!-- Twitter Card -->
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:title" content="Premium Tile Collection | Surprise Granite">
  <meta name="twitter:description" content="460+ premium tiles for kitchen & bathroom. Porcelain, ceramic, mosaic & marble tiles.">

  <!-- Structured Data for SEO -->
  <script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@type": "CollectionPage",
    "name": "Tile Collection",
    "description": "Premium tile collection including porcelain, ceramic, marble, and mosaic tiles for kitchen backsplash, bathroom floors, and walls.",
    "url": "https://www.surprisegranite.com/materials/all-tile/",
    "isPartOf": {
      "@type": "WebSite",
      "name": "Surprise Granite",
      "url": "https://www.surprisegranite.com"
    },
    "provider": {
      "@type": "LocalBusiness",
      "name": "Surprise Granite",
      "image": "https://www.surprisegranite.com/images/logo.png",
      "telephone": "+1-602-833-3189",
      "address": {
        "@type": "PostalAddress",
        "addressLocality": "Surprise",
        "addressRegion": "AZ",
        "addressCountry": "US"
      },
      "geo": {
        "@type": "GeoCoordinates",
        "latitude": 33.6292,
        "longitude": -112.3679
      },
      "areaServed": ["Phoenix", "Scottsdale", "Glendale", "Peoria", "Surprise", "Mesa", "Tempe", "Chandler"],
      "priceRange": "$$"
    },
    "mainEntity": {
      "@type": "ItemList",
      "itemListElement": [
        {"@type": "ListItem", "position": 1, "name": "Porcelain Tile"},
        {"@type": "ListItem", "position": 2, "name": "Ceramic Tile"},
        {"@type": "ListItem", "position": 3, "name": "Mosaic Tile"},
        {"@type": "ListItem", "position": 4, "name": "Marble Tile"},
        {"@type": "ListItem", "position": 5, "name": "Glass Tile"}
      ]
    }
  }
  </script>

  <!-- Google Fonts - Preconnect for performance -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">

  <!-- Unified Navigation -->
  <link rel="stylesheet" href="/css/unified-nav.css?v=20260129">

  <style>
    /* ============================================
       CSS VARIABLES
       ============================================ */
    :root {
      --primary: #1a1a2e;
      --accent: #f9cb00;
      --accent-dark: #d9a800;
      --text: #333;
      --text-light: #666;
      --bg: #fff;
      --bg-light: #f8f9fa;
      --border: #e0e0e0;
      --shadow: 0 2px 8px rgba(0,0,0,0.1);
      --radius: 8px;
    }

    /* ============================================
       RESET & BASE
       ============================================ */
    *, *::before, *::after {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }

    html {
      font-size: 16px;
      -webkit-font-smoothing: antialiased;
    }

    body {
      font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
      color: var(--text);
      background: var(--bg);
      line-height: 1.5;
      padding-top: 140px; /* Account for fixed nav (140px desktop) */
    }

    @media (max-width: 767px) {
      body {
        padding-top: 64px; /* Mobile nav is 64px */
      }
    }

    a {
      text-decoration: none;
      color: inherit;
    }

    img {
      max-width: 100%;
      height: auto;
      display: block;
    }

    /* ============================================
       HERO SECTION
       ============================================ */
    .hero {
      background: linear-gradient(135deg, var(--primary) 0%, #2d2d4a 100%);
      color: #fff;
      padding: 40px 20px 30px;
      text-align: center;
    }

    .hero h1 {
      font-size: clamp(1.75rem, 5vw, 2.5rem);
      font-weight: 700;
      margin-bottom: 12px;
    }

    .hero p {
      font-size: 1rem;
      opacity: 0.9;
      max-width: 600px;
      margin: 0 auto;
    }

    /* ============================================
       MAIN LAYOUT
       ============================================ */
    .main-container {
      max-width: 1400px;
      margin: 0 auto;
      padding: 20px;
    }

    .content-layout {
      display: grid;
      grid-template-columns: 280px 1fr;
      gap: 24px;
    }

    /* ============================================
       FILTER SIDEBAR
       ============================================ */
    .filter-sidebar {
      position: sticky;
      top: 160px; /* Nav height (140px) + 20px gap */
      align-self: start;
      max-height: calc(100vh - 180px);
      overflow-y: auto;
      z-index: 100;
      scrollbar-width: thin;
    }

    .filter-sidebar::-webkit-scrollbar {
      width: 6px;
    }

    .filter-sidebar::-webkit-scrollbar-track {
      background: transparent;
    }

    .filter-sidebar::-webkit-scrollbar-thumb {
      background: #ccc;
      border-radius: 3px;
    }

    .filter-sidebar::-webkit-scrollbar-thumb:hover {
      background: #aaa;
    }

    .filter-card {
      background: var(--bg-light);
      border-radius: 12px;
      padding: 16px;
    }

    /* Results Bar */
    .results-bar {
      background: var(--primary);
      color: #fff;
      padding: 12px 14px;
      border-radius: var(--radius);
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 12px;
    }

    .results-bar .count {
      font-size: 13px;
    }

    .results-bar strong {
      color: var(--accent);
    }

    .clear-all-btn {
      background: rgba(255,255,255,0.2);
      border: none;
      color: #fff;
      padding: 6px 12px;
      border-radius: 4px;
      cursor: pointer;
      font-size: 12px;
      transition: background 0.2s;
    }

    .clear-all-btn:hover {
      background: rgba(255,255,255,0.3);
    }

    /* Search Box */
    .search-box {
      margin-bottom: 12px;
    }

    .search-input {
      width: 100%;
      padding: 10px 12px;
      border: 1px solid var(--border);
      border-radius: 6px;
      font-size: 14px;
      outline: none;
      transition: border-color 0.2s;
    }

    .search-input:focus {
      border-color: var(--accent);
    }

    /* Filter Groups */
    .filter-group {
      background: #fff;
      border-radius: var(--radius);
      margin-bottom: 8px;
      border: 1px solid var(--border);
      overflow: hidden;
    }

    .filter-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 12px 14px;
      cursor: pointer;
      user-select: none;
    }

    .filter-header:hover {
      background: rgba(0,0,0,0.02);
    }

    .filter-header-left {
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .filter-arrow {
      font-size: 10px;
      color: var(--text-light);
      transition: transform 0.2s;
    }

    .filter-group.expanded .filter-arrow {
      transform: rotate(180deg);
    }

    .filter-label {
      font-size: 12px;
      font-weight: 700;
      text-transform: uppercase;
      color: var(--primary);
    }

    .filter-badge {
      background: var(--accent);
      color: var(--primary);
      font-size: 10px;
      padding: 2px 8px;
      border-radius: 10px;
      font-weight: 700;
      display: none;
    }

    .filter-badge.visible {
      display: inline-block;
    }

    .filter-clear {
      font-size: 11px;
      color: var(--text-light);
      background: none;
      border: none;
      cursor: pointer;
      padding: 4px 8px;
    }

    .filter-clear:hover {
      color: var(--text);
    }

    /* Filter Options */
    .filter-options {
      display: none;
      padding: 8px 10px;
      background: #fafafa;
      border-top: 2px solid var(--accent);
      max-height: 180px;
      overflow-y: auto;
    }

    .filter-group.expanded .filter-options {
      display: block;
    }

    .filter-option {
      display: flex;
      align-items: center;
      padding: 8px 10px;
      border-radius: 4px;
      cursor: pointer;
      transition: background 0.15s;
    }

    .filter-option:hover {
      background: rgba(249,203,0,0.1);
    }

    .filter-option.active {
      background: rgba(249,203,0,0.15);
    }

    .filter-checkbox {
      width: 16px;
      height: 16px;
      border: 2px solid #ccc;
      border-radius: 3px;
      margin-right: 10px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 11px;
      background: #fff;
      flex-shrink: 0;
      transition: all 0.15s;
    }

    .filter-option.active .filter-checkbox {
      background: var(--accent);
      border-color: var(--accent-dark);
      color: var(--primary);
    }

    .filter-option-text {
      font-size: 13px;
      color: var(--text);
    }

    /* ============================================
       TILE GRID
       ============================================ */
    .tile-grid {
      display: grid;
      grid-template-columns: repeat(3, 1fr);
      gap: 20px;
    }

    .tile-card {
      background: #fff;
      border-radius: 10px;
      overflow: hidden;
      transition: transform 0.2s, box-shadow 0.2s;
    }

    .tile-card:hover {
      transform: translateY(-4px);
      box-shadow: var(--shadow);
    }

    .tile-card a {
      display: block;
    }

    .tile-image-wrapper {
      aspect-ratio: 1;
      background: #f5f5f5;
      overflow: hidden;
    }

    .tile-image-wrapper img {
      width: 100%;
      height: 100%;
      object-fit: cover;
      transition: transform 0.3s;
    }

    .tile-card:hover .tile-image-wrapper img {
      transform: scale(1.05);
    }

    .tile-info {
      padding: 12px;
    }

    .tile-name {
      font-size: 14px;
      font-weight: 600;
      color: var(--text);
      margin-bottom: 4px;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }

    .tile-meta {
      font-size: 12px;
      color: var(--text-light);
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }

    /* Loading State */
    .loading-message {
      text-align: center;
      padding: 60px 20px;
      color: var(--text-light);
      grid-column: 1 / -1;
    }

    /* Empty State */
    .empty-state {
      text-align: center;
      padding: 60px 20px;
      grid-column: 1 / -1;
    }

    .empty-state h3 {
      margin-bottom: 8px;
      color: var(--text);
    }

    .empty-state p {
      color: var(--text-light);
    }

    /* ============================================
       MOBILE FILTER BAR & DRAWER
       ============================================ */
    .mobile-filter-bar {
      display: none;
      position: sticky;
      top: 64px;
      z-index: 90;
      background: var(--bg);
      border-bottom: 1px solid var(--border);
      padding: 10px 12px;
      gap: 8px;
      align-items: center;
    }

    .mobile-filter-btn {
      display: flex;
      align-items: center;
      gap: 6px;
      padding: 10px 16px;
      background: var(--primary);
      color: #fff;
      border: none;
      border-radius: 8px;
      font-size: 14px;
      font-weight: 500;
      cursor: pointer;
      min-height: 44px;
    }

    .mobile-filter-btn svg {
      width: 18px;
      height: 18px;
      fill: currentColor;
    }

    .mobile-filter-badge {
      background: var(--accent);
      color: var(--primary);
      font-size: 11px;
      font-weight: 700;
      padding: 2px 7px;
      border-radius: 10px;
      margin-left: 4px;
    }

    .mobile-sort-btn {
      padding: 10px 14px;
      background: var(--bg-light);
      border: 1px solid var(--border);
      border-radius: 8px;
      font-size: 13px;
      color: var(--text);
      cursor: pointer;
      min-height: 44px;
    }

    .mobile-results-count {
      margin-left: auto;
      font-size: 12px;
      color: var(--text-light);
    }

    /* Mobile Filter Drawer (Bottom Sheet) */
    .mobile-filter-drawer {
      position: fixed;
      bottom: 0;
      left: 0;
      right: 0;
      background: var(--bg);
      border-radius: 20px 20px 0 0;
      box-shadow: 0 -4px 20px rgba(0,0,0,0.15);
      z-index: 1000;
      transform: translateY(100%);
      transition: transform 0.3s cubic-bezier(0.32, 0.72, 0, 1);
      max-height: 85vh;
      display: flex;
      flex-direction: column;
    }

    .mobile-filter-drawer.open {
      transform: translateY(0);
    }

    .mobile-filter-drawer-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 16px 20px;
      border-bottom: 1px solid var(--border);
      flex-shrink: 0;
    }

    .mobile-filter-drawer-header h3 {
      font-size: 18px;
      font-weight: 600;
    }

    .mobile-filter-drawer-close {
      width: 32px;
      height: 32px;
      border: none;
      background: var(--bg-light);
      border-radius: 50%;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 18px;
      color: var(--text-light);
    }

    .mobile-filter-drawer-content {
      flex: 1;
      overflow-y: auto;
      -webkit-overflow-scrolling: touch;
      overscroll-behavior: contain;
      padding: 16px;
    }

    .mobile-filter-drawer-footer {
      display: flex;
      gap: 12px;
      padding: 16px 20px;
      border-top: 1px solid var(--border);
      background: var(--bg);
      padding-bottom: calc(16px + env(safe-area-inset-bottom, 0px));
    }

    .mobile-filter-clear-btn {
      flex: 1;
      padding: 14px;
      background: var(--bg-light);
      border: 1px solid var(--border);
      border-radius: 10px;
      font-size: 15px;
      font-weight: 500;
      cursor: pointer;
      min-height: 48px;
    }

    .mobile-filter-apply-btn {
      flex: 2;
      padding: 14px;
      background: var(--accent);
      color: var(--primary);
      border: none;
      border-radius: 10px;
      font-size: 15px;
      font-weight: 600;
      cursor: pointer;
      min-height: 48px;
    }

    .mobile-filter-overlay {
      position: fixed;
      inset: 0;
      background: rgba(0,0,0,0.5);
      z-index: 999;
      opacity: 0;
      visibility: hidden;
      transition: opacity 0.3s, visibility 0.3s;
    }

    .mobile-filter-overlay.visible {
      opacity: 1;
      visibility: visible;
    }

    /* Mobile drawer filter groups */
    .mobile-filter-drawer .filter-group {
      margin-bottom: 12px;
    }

    .mobile-filter-drawer .filter-header {
      padding: 14px 16px;
    }

    .mobile-filter-drawer .filter-option {
      padding: 12px 14px;
      min-height: 44px;
    }

    .mobile-filter-drawer .filter-checkbox {
      width: 20px;
      height: 20px;
    }

    /* ============================================
       MOBILE SWIPE BUTTON
       ============================================ */
    .swipe-mode-btn {
      display: none;
      position: fixed;
      bottom: 20px;
      right: 20px;
      background: var(--accent);
      color: var(--primary);
      border: none;
      padding: 14px 20px;
      border-radius: 30px;
      font-weight: 600;
      font-size: 14px;
      cursor: pointer;
      box-shadow: 0 4px 12px rgba(0,0,0,0.2);
      z-index: 100;
    }

    /* ============================================
       RESPONSIVE - TABLET
       ============================================ */
    @media (max-width: 991px) {
      .content-layout {
        grid-template-columns: 240px 1fr;
        gap: 20px;
      }

      .tile-grid {
        grid-template-columns: repeat(2, 1fr);
        gap: 16px;
      }
    }

    /* ============================================
       RESPONSIVE - MOBILE
       ============================================ */
    @media (max-width: 767px) {
      body {
        /* Enable smooth momentum scrolling on iOS */
        -webkit-overflow-scrolling: touch;
      }

      .hero {
        padding: 24px 16px 20px;
      }

      .hero h1 {
        font-size: 1.5rem;
      }

      .hero p {
        font-size: 0.9rem;
      }

      .main-container {
        padding: 0 12px 12px;
      }

      .content-layout {
        grid-template-columns: 1fr;
      }

      /* Hide filter sidebar on mobile */
      .filter-sidebar {
        display: none;
      }

      /* Show mobile filter bar */
      .mobile-filter-bar {
        display: flex;
      }

      /* Full width grid with better touch targets */
      .tile-grid {
        grid-template-columns: repeat(2, 1fr);
        gap: 10px;
      }

      .tile-card {
        border-radius: 8px;
        /* Prevent content shift during scroll */
        contain: layout style paint;
      }

      .tile-card:active {
        transform: scale(0.98);
        transition: transform 0.1s;
      }

      .tile-image-wrapper {
        border-radius: 8px 8px 0 0;
      }

      .tile-info {
        padding: 10px;
      }

      .tile-name {
        font-size: 13px;
        line-height: 1.3;
      }

      .tile-meta {
        font-size: 11px;
      }

      /* Show swipe mode button - position above safe area */
      .swipe-mode-btn {
        display: block;
        bottom: calc(20px + env(safe-area-inset-bottom, 0px));
      }
    }

    /* ============================================
       RESPONSIVE - SMALL MOBILE
       ============================================ */
    @media (max-width: 380px) {
      .tile-grid {
        gap: 8px;
      }

      .tile-info {
        padding: 8px;
      }

      .tile-name {
        font-size: 12px;
      }

      .tile-meta {
        font-size: 10px;
      }
    }
  </style>
</head>
<body>
  <!-- Unified Navigation Placeholder -->
  <div id="unified-nav-placeholder"></div>

  <!-- Hero Section -->
  <section class="hero">
    <h1>Premium Tile Collection</h1>
    <p>Browse 460+ porcelain, ceramic & mosaic tiles from top brands. Professional installation available in Phoenix Metro.</p>
  </section>

  <!-- Mobile Filter Bar -->
  <div class="mobile-filter-bar" id="mobileFilterBar">
    <button class="mobile-filter-btn" id="openMobileFilters" aria-label="Open filters">
      <svg viewBox="0 0 24 24"><path d="M10 18h4v-2h-4v2zM3 6v2h18V6H3zm3 7h12v-2H6v2z"/></svg>
      Filters
      <span class="mobile-filter-badge" id="mobileFilterBadge" style="display:none;">0</span>
    </button>
    <span class="mobile-results-count" id="mobileResultsCount">0 tiles</span>
  </div>

  <!-- Mobile Filter Drawer -->
  <div class="mobile-filter-overlay" id="mobileFilterOverlay"></div>
  <div class="mobile-filter-drawer" id="mobileFilterDrawer" role="dialog" aria-label="Filter options">
    <div class="mobile-filter-drawer-header">
      <h3>Filters</h3>
      <button class="mobile-filter-drawer-close" id="closeMobileFilters" aria-label="Close filters">&times;</button>
    </div>
    <div class="mobile-filter-drawer-content" id="mobileFilterContent">
      <!-- Filters will be cloned here -->
    </div>
    <div class="mobile-filter-drawer-footer">
      <button class="mobile-filter-clear-btn" id="mobileClearFilters">Clear All</button>
      <button class="mobile-filter-apply-btn" id="mobileApplyFilters">Show Results</button>
    </div>
  </div>

  <!-- Main Content -->
  <main class="main-container">
    <div class="content-layout">

      <!-- Filter Sidebar (Desktop Only) -->
      <aside class="filter-sidebar">
        <div class="filter-card">
          <!-- Results Bar -->
          <div class="results-bar">
            <span class="count">Showing <strong id="count-showing">0</strong> of <strong id="count-total">0</strong></span>
            <button class="clear-all-btn" onclick="clearAllFilters()">Clear All</button>
          </div>

          <!-- Search -->
          <div class="search-box">
            <input type="text" class="search-input" id="tile-search" placeholder="Search tiles..." oninput="handleSearch(this.value)">
          </div>

          <!-- Filter Groups Container -->
          <div id="filter-groups"></div>
        </div>
      </aside>

      <!-- Tile Grid -->
      <section class="tile-section">
        <div class="tile-grid" id="tile-grid">
          <div class="loading-message">Loading tiles...</div>
        </div>
      </section>
    </div>
  </main>

  <!-- Mobile Swipe Mode Button -->
  <button class="swipe-mode-btn" onclick="activateSwipeMode()">
    Swipe Mode
  </button>

  <!-- Unified Navigation Script -->
  <script src="/js/unified-nav.js?v=20260121"></script>

  <!-- Swipe Cards Script (Mobile) -->
  <script src="/js/swipe-cards-universal.js?v=20260121"></script>

  <script>
    /**
     * Tile Filter System - Clean Version
     * No Webflow dependencies
     */
    (function() {
      'use strict';

      const CONFIG = {
        jsonPath: '/data/tile.json',
        itemsPerPage: 48
      };

      const FILTER_DEFINITIONS = [
        { key: 'brand', label: 'Brand', dataKey: 'brands' },
        { key: 'material', label: 'Material', dataKey: 'materials' },
        { key: 'style', label: 'Style', dataKey: 'styles' },
        { key: 'color', label: 'Color', dataKey: 'colors' }
      ];

      let allTiles = [];
      let filteredTiles = [];
      let filters = {};
      let currentPage = 1;

      let activeFilters = {
        brand: [],
        material: [],
        color: [],
        style: [],
        search: ''
      };

      // Initialize
      async function init() {
        console.log('Tile Filter System initializing...');

        try {
          const response = await fetch(CONFIG.jsonPath);
          if (!response.ok) throw new Error('Failed to load tile data');

          const data = await response.json();
          allTiles = data.tiles || [];
          filters = data.filters || {};

          console.log('Loaded', allTiles.length, 'tiles');

          buildFilterUI();
          applyFilters();
          setupInfiniteScroll();

        } catch (error) {
          console.error('Failed to initialize:', error);
          document.getElementById('tile-grid').innerHTML =
            '<div class="empty-state"><h3>Error Loading Tiles</h3><p>Please refresh the page to try again.</p></div>';
        }
      }

      // Build Filter UI
      function buildFilterUI() {
        const container = document.getElementById('filter-groups');
        if (!container) return;

        container.innerHTML = '';

        FILTER_DEFINITIONS.forEach((def, index) => {
          const options = filters[def.dataKey] || [];
          if (options.length === 0) return;

          const group = createFilterGroup(def.label, def.key, options, index === 0);
          container.appendChild(group);
        });
      }

      // Create Filter Group
      function createFilterGroup(label, filterKey, options, startExpanded) {
        const group = document.createElement('div');
        group.className = 'filter-group' + (startExpanded ? ' expanded' : '');
        group.dataset.filterKey = filterKey;

        group.innerHTML = `
          <div class="filter-header">
            <div class="filter-header-left">
              <span class="filter-arrow">▼</span>
              <span class="filter-label">${label}</span>
              <span class="filter-badge">0</span>
            </div>
            <button class="filter-clear">Clear</button>
          </div>
          <div class="filter-options"></div>
        `;

        const optionsContainer = group.querySelector('.filter-options');

        options.forEach(value => {
          const option = document.createElement('div');
          option.className = 'filter-option';
          option.dataset.value = value;
          option.innerHTML = `
            <div class="filter-checkbox"></div>
            <span class="filter-option-text">${formatName(value)}</span>
          `;

          option.addEventListener('click', () => toggleOption(option, filterKey, value, group));
          optionsContainer.appendChild(option);
        });

        // Header click - toggle expand
        group.querySelector('.filter-header').addEventListener('click', (e) => {
          if (e.target.classList.contains('filter-clear')) return;
          group.classList.toggle('expanded');
        });

        // Clear button
        group.querySelector('.filter-clear').addEventListener('click', (e) => {
          e.stopPropagation();
          clearFilterGroup(filterKey, group);
        });

        return group;
      }

      // Toggle Option
      function toggleOption(option, filterKey, value, group) {
        const isActive = option.classList.contains('active');

        if (isActive) {
          option.classList.remove('active');
          option.querySelector('.filter-checkbox').textContent = '';
          activeFilters[filterKey] = activeFilters[filterKey].filter(v => v !== value);
        } else {
          option.classList.add('active');
          option.querySelector('.filter-checkbox').textContent = '✓';
          if (!activeFilters[filterKey].includes(value)) {
            activeFilters[filterKey].push(value);
          }
        }

        updateBadge(group, filterKey);
        currentPage = 1;
        applyFilters();
      }

      // Update Badge
      function updateBadge(group, filterKey) {
        const badge = group.querySelector('.filter-badge');
        const count = activeFilters[filterKey].length;
        badge.textContent = count;
        badge.classList.toggle('visible', count > 0);
      }

      // Clear Filter Group
      function clearFilterGroup(filterKey, group) {
        activeFilters[filterKey] = [];
        group.querySelectorAll('.filter-option.active').forEach(opt => {
          opt.classList.remove('active');
          opt.querySelector('.filter-checkbox').textContent = '';
        });
        updateBadge(group, filterKey);
        currentPage = 1;
        applyFilters();
      }

      // Clear All Filters (global function)
      window.clearAllFilters = function() {
        activeFilters = { brand: [], material: [], color: [], style: [], search: '' };

        document.querySelectorAll('.filter-option.active').forEach(opt => {
          opt.classList.remove('active');
          opt.querySelector('.filter-checkbox').textContent = '';
        });

        document.querySelectorAll('.filter-badge').forEach(badge => {
          badge.classList.remove('visible');
        });

        const searchInput = document.getElementById('tile-search');
        if (searchInput) searchInput.value = '';

        currentPage = 1;
        applyFilters();
      };

      // Handle Search (global function)
      window.handleSearch = function(value) {
        activeFilters.search = value.toLowerCase();
        currentPage = 1;
        applyFilters();
      };

      // Format Name
      function formatName(value) {
        if (!value) return '';
        if (value === 'msi') return 'MSI';
        if (value === 'bravo-tile') return 'Bravo Tile';
        return value.split('-').map(w => w.charAt(0).toUpperCase() + w.slice(1)).join(' ');
      }

      // Apply Filters
      function applyFilters() {
        filteredTiles = allTiles.filter(tile => {
          // Search filter
          if (activeFilters.search) {
            const s = activeFilters.search;
            const match = (tile.name || '').toLowerCase().includes(s) ||
                          (tile.material || '').toLowerCase().includes(s) ||
                          (tile.type || '').toLowerCase().includes(s) ||
                          (tile.brand || '').toLowerCase().includes(s);
            if (!match) return false;
          }

          // Category filters
          if (activeFilters.material.length > 0 && !activeFilters.material.includes(tile.material)) return false;
          if (activeFilters.color.length > 0 && !activeFilters.color.includes(tile.primaryColor)) return false;
          if (activeFilters.style.length > 0 && !activeFilters.style.includes(tile.type)) return false;
          if (activeFilters.brand.length > 0 && !activeFilters.brand.includes(tile.brand)) return false;

          return true;
        });

        renderTiles();
        updateCount();
      }

      // Render Tiles
      function renderTiles() {
        const grid = document.getElementById('tile-grid');
        if (!grid) return;

        const tilesToShow = filteredTiles.slice(0, currentPage * CONFIG.itemsPerPage);

        if (tilesToShow.length === 0) {
          grid.innerHTML = `
            <div class="empty-state">
              <h3>No tiles found</h3>
              <p>Try adjusting your filters or search term.</p>
            </div>
          `;
          return;
        }

        grid.innerHTML = tilesToShow.map(tile => {
          const brandLabel = tile.brand === 'bravo-tile' ? 'Bravo Tile' :
                            tile.brand === 'msi' ? 'MSI' : tile.brand;
          return `
            <div class="tile-card">
              <a href="/tiles/${tile.slug}/">
                <div class="tile-image-wrapper">
                  <img src="${tile.primaryImage || '/images/placeholder-tile.jpg'}"
                       alt="${tile.name}"
                       loading="lazy"
                       onerror="this.src='/images/placeholder-tile.jpg'">
                </div>
                <div class="tile-info">
                  <div class="tile-name">${tile.name}</div>
                  <div class="tile-meta">${brandLabel}${tile.material ? ' · ' + tile.material : ''}</div>
                </div>
              </a>
            </div>
          `;
        }).join('');
      }

      // Update Count
      function updateCount() {
        const showing = Math.min(currentPage * CONFIG.itemsPerPage, filteredTiles.length);
        const showingEl = document.getElementById('count-showing');
        const totalEl = document.getElementById('count-total');
        if (showingEl) showingEl.textContent = showing;
        if (totalEl) totalEl.textContent = filteredTiles.length;
      }

      // Setup Infinite Scroll
      function setupInfiniteScroll() {
        const grid = document.getElementById('tile-grid');
        if (!grid || !grid.parentElement) return;

        const sentinel = document.createElement('div');
        sentinel.style.height = '1px';
        grid.parentElement.appendChild(sentinel);

        const observer = new IntersectionObserver((entries) => {
          entries.forEach(entry => {
            if (entry.isIntersecting) {
              const totalPages = Math.ceil(filteredTiles.length / CONFIG.itemsPerPage);
              if (currentPage < totalPages) {
                currentPage++;
                renderTiles();
                updateCount();
              }
            }
          });
        }, { rootMargin: '200px' });

        observer.observe(sentinel);
      }

      // Activate Swipe Mode (global function for mobile)
      window.activateSwipeMode = function() {
        if (typeof SwipeCardsUniversal !== 'undefined' && SwipeCardsUniversal.init) {
          SwipeCardsUniversal.init({
            items: filteredTiles.map(tile => ({
              name: tile.name,
              image: tile.primaryImage || '/images/placeholder-tile.jpg',
              url: '/tiles/' + tile.slug + '/',
              brand: tile.brand === 'bravo-tile' ? 'Bravo Tile' : tile.brand === 'msi' ? 'MSI' : tile.brand
            }))
          });
        } else {
          console.warn('SwipeCardsUniversal not available');
        }
      };

      // ===== MOBILE FILTER DRAWER =====
      function initMobileFilters() {
        const openBtn = document.getElementById('openMobileFilters');
        const closeBtn = document.getElementById('closeMobileFilters');
        const drawer = document.getElementById('mobileFilterDrawer');
        const overlay = document.getElementById('mobileFilterOverlay');
        const clearBtn = document.getElementById('mobileClearFilters');
        const applyBtn = document.getElementById('mobileApplyFilters');
        const mobileContent = document.getElementById('mobileFilterContent');

        if (!openBtn || !drawer) return;

        // Clone filter groups to mobile drawer
        function syncFiltersToMobile() {
          const desktopFilters = document.getElementById('filter-groups');
          if (desktopFilters && mobileContent) {
            mobileContent.innerHTML = desktopFilters.innerHTML;
            // Re-attach event listeners
            mobileContent.querySelectorAll('.filter-option').forEach(option => {
              const filterKey = option.closest('.filter-group')?.dataset.filterKey;
              const value = option.dataset.value;
              if (filterKey && value) {
                option.addEventListener('click', () => {
                  toggleOption(option, filterKey, value, option.closest('.filter-group'));
                  updateMobileBadge();
                });
              }
            });
            mobileContent.querySelectorAll('.filter-header').forEach(header => {
              header.addEventListener('click', (e) => {
                if (!e.target.classList.contains('filter-clear')) {
                  header.closest('.filter-group')?.classList.toggle('expanded');
                }
              });
            });
            mobileContent.querySelectorAll('.filter-clear').forEach(btn => {
              btn.addEventListener('click', (e) => {
                e.stopPropagation();
                const group = btn.closest('.filter-group');
                const filterKey = group?.dataset.filterKey;
                if (filterKey && group) clearFilterGroup(filterKey, group);
                updateMobileBadge();
              });
            });
          }
        }

        function openDrawer() {
          syncFiltersToMobile();
          drawer.classList.add('open');
          overlay.classList.add('visible');
          document.body.style.overflow = 'hidden';
        }

        function closeDrawer() {
          drawer.classList.remove('open');
          overlay.classList.remove('visible');
          document.body.style.overflow = '';
        }

        openBtn.addEventListener('click', openDrawer);
        closeBtn.addEventListener('click', closeDrawer);
        overlay.addEventListener('click', closeDrawer);
        clearBtn.addEventListener('click', () => {
          window.clearAllFilters();
          updateMobileBadge();
        });
        applyBtn.addEventListener('click', closeDrawer);

        // Handle swipe down to close
        let startY = 0;
        drawer.addEventListener('touchstart', (e) => {
          startY = e.touches[0].clientY;
        }, { passive: true });

        drawer.addEventListener('touchmove', (e) => {
          const deltaY = e.touches[0].clientY - startY;
          if (deltaY > 100) closeDrawer();
        }, { passive: true });
      }

      // Update mobile filter badge
      function updateMobileBadge() {
        const badge = document.getElementById('mobileFilterBadge');
        const count = Object.values(activeFilters).flat().filter(v => v && v.length > 0).length -
                      (activeFilters.search ? 1 : 0);
        const totalFilters = activeFilters.brand.length + activeFilters.material.length +
                             activeFilters.color.length + activeFilters.style.length;
        if (badge) {
          badge.textContent = totalFilters;
          badge.style.display = totalFilters > 0 ? 'inline' : 'none';
        }
      }

      // Update mobile results count
      function updateMobileCount() {
        const el = document.getElementById('mobileResultsCount');
        if (el) el.textContent = `${filteredTiles.length} tiles`;
      }

      // Override updateCount to also update mobile
      const originalUpdateCount = updateCount;
      updateCount = function() {
        originalUpdateCount();
        updateMobileCount();
        updateMobileBadge();
      };

      // Start
      if (document.readyState === 'loading') {
        document.addEventListener('DOMContentLoaded', () => {
          init();
          setTimeout(initMobileFilters, 100);
        });
      } else {
        init();
        setTimeout(initMobileFilters, 100);
      }
    })();
  </script>
</body>
</html>
