<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8"/>
  <title>Join Stone Yards Network | Surprise Granite</title>
  <meta name="description" content="List your stone inventory on our interactive Stone Yards map. Distributors, fabricators with bone yards, and anyone with slabs can join free and reach thousands of buyers."/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <link rel="canonical" href="https://surprisegranite.com/distributor/signup/"/>
  <meta property="og:title" content="Join the Stone Yards Network | Surprise Granite"/>
  <meta property="og:description" content="Get featured on our interactive map. Send customers our way for fabrication, we'll send buyers to you for slabs."/>
  <link href="https://cdn.prod.website-files.com/6456ce4476abb25581fbad0c/6456ce4476abb269c6fbb176_Surprise-Granite-favicon-32x32px.png" rel="shortcut icon" type="image/x-icon"/>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet"/>
  <script src="https://unpkg.com/@supabase/supabase-js@2"></script>

  <!-- Unified Navigation -->
  <link rel="stylesheet" href="/css/unified-nav.css?v=20260129">
  <script defer src="/js/unified-nav.js?v=20260129"></script>

  <!-- Leaflet for mini map -->
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"/>
  <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>

  <style>
    :root {
      --gold: #f9cb00;
      --gold-dark: #d4a900;
      --gold-glow: rgba(249, 203, 0, 0.35);
      --navy: #1a1a2e;
      --navy-light: #2d2d44;
      --bg: #ffffff;
      --bg-secondary: #f8fafc;
      --bg-tertiary: #f1f5f9;
      --border: #e2e8f0;
      --text: #1a1a2e;
      --text-secondary: #64748b;
      --text-muted: #94a3b8;
      --success: #22c55e;
      --error: #ef4444;
    }

    * { margin: 0; padding: 0; box-sizing: border-box; }

    body {
      font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
      background: var(--bg-secondary);
      min-height: 100vh;
      color: var(--text);
      padding-top: 140px;
      line-height: 1.6;
    }

    @media (max-width: 991px) {
      body { padding-top: 80px; }
    }

    /* Hero Section with Map Background */
    .hero-section {
      position: relative;
      background: linear-gradient(135deg, var(--bg) 0%, var(--bg-secondary) 100%);
      border-bottom: 1px solid var(--border);
      padding: 60px 24px;
      overflow: hidden;
    }

    .hero-map-bg {
      position: absolute;
      top: 0;
      right: 0;
      width: 50%;
      height: 100%;
      opacity: 0.15;
      pointer-events: none;
    }

    .hero-map-bg::after {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: linear-gradient(90deg, var(--bg) 0%, transparent 50%);
    }

    #heroMap {
      width: 100%;
      height: 100%;
    }

    .hero-content {
      position: relative;
      z-index: 2;
      max-width: 1200px;
      margin: 0 auto;
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 48px;
      align-items: center;
    }

    @media (max-width: 900px) {
      .hero-content {
        grid-template-columns: 1fr;
        text-align: center;
      }
      .hero-map-bg {
        display: none;
      }
    }

    .hero-badge {
      display: inline-flex;
      align-items: center;
      gap: 8px;
      background: var(--navy);
      color: var(--gold);
      padding: 10px 20px;
      border-radius: 100px;
      font-size: 13px;
      font-weight: 700;
      letter-spacing: 0.5px;
      margin-bottom: 20px;
    }

    .hero-title {
      font-size: clamp(32px, 5vw, 48px);
      font-weight: 800;
      margin-bottom: 16px;
      letter-spacing: -1px;
      line-height: 1.1;
      color: var(--navy);
    }

    .hero-title span {
      color: var(--gold-dark);
    }

    .hero-subtitle {
      font-size: 18px;
      color: var(--text-secondary);
      margin-bottom: 32px;
      line-height: 1.7;
    }

    /* Stats */
    .hero-stats {
      display: flex;
      gap: 32px;
      flex-wrap: wrap;
    }

    @media (max-width: 900px) {
      .hero-stats {
        justify-content: center;
      }
    }

    .hero-stat {
      text-align: left;
    }

    @media (max-width: 900px) {
      .hero-stat {
        text-align: center;
      }
    }

    .hero-stat-value {
      font-size: 36px;
      font-weight: 800;
      color: var(--navy);
      line-height: 1;
    }

    .hero-stat-label {
      font-size: 13px;
      color: var(--text-muted);
      margin-top: 4px;
    }

    /* Preview Card in Hero */
    .hero-preview {
      background: var(--bg);
      border-radius: 20px;
      padding: 24px;
      box-shadow: 0 20px 60px rgba(0, 0, 0, 0.08);
      border: 1px solid var(--border);
    }

    @media (max-width: 900px) {
      .hero-preview {
        display: none;
      }
    }

    .preview-header {
      display: flex;
      align-items: center;
      gap: 12px;
      margin-bottom: 16px;
    }

    .preview-icon {
      width: 48px;
      height: 48px;
      background: linear-gradient(135deg, var(--gold) 0%, var(--gold-dark) 100%);
      border-radius: 12px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 24px;
    }

    .preview-title {
      font-size: 18px;
      font-weight: 700;
      color: var(--navy);
    }

    .preview-subtitle {
      font-size: 13px;
      color: var(--text-secondary);
    }

    .preview-map {
      height: 180px;
      border-radius: 12px;
      overflow: hidden;
      margin-bottom: 16px;
    }

    #previewMapEl {
      width: 100%;
      height: 100%;
    }

    .preview-features {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 8px;
    }

    .preview-feature {
      display: flex;
      align-items: center;
      gap: 8px;
      font-size: 13px;
      color: var(--text-secondary);
    }

    .preview-feature svg {
      color: var(--success);
      flex-shrink: 0;
    }

    /* Main Content */
    .signup-container {
      max-width: 900px;
      margin: 0 auto;
      padding: 48px 24px 80px;
    }

    /* Two Column Layout */
    .content-grid {
      display: grid;
      grid-template-columns: 1fr 400px;
      gap: 48px;
      align-items: start;
    }

    @media (max-width: 900px) {
      .content-grid {
        grid-template-columns: 1fr;
        gap: 32px;
      }
    }

    /* Benefits Column */
    .benefits-column {
      order: 2;
    }

    @media (max-width: 900px) {
      .benefits-column {
        order: 1;
      }
    }

    .benefits-title {
      font-size: 20px;
      font-weight: 700;
      color: var(--navy);
      margin-bottom: 20px;
      display: flex;
      align-items: center;
      gap: 10px;
    }

    .benefits-title svg {
      color: var(--gold-dark);
    }

    .benefit-list {
      display: flex;
      flex-direction: column;
      gap: 16px;
    }

    .benefit-item {
      display: flex;
      gap: 14px;
      align-items: flex-start;
      padding: 16px;
      background: var(--bg);
      border: 1px solid var(--border);
      border-radius: 12px;
    }

    .benefit-icon {
      width: 40px;
      height: 40px;
      background: var(--bg-tertiary);
      border-radius: 10px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 20px;
      flex-shrink: 0;
    }

    .benefit-content h4 {
      font-size: 15px;
      font-weight: 600;
      color: var(--navy);
      margin-bottom: 4px;
    }

    .benefit-content p {
      font-size: 14px;
      color: var(--text-secondary);
      line-height: 1.5;
    }

    /* How It Works */
    .how-it-works {
      margin-top: 32px;
      padding: 24px;
      background: var(--bg);
      border: 1px solid var(--border);
      border-radius: 16px;
    }

    .hiw-title {
      font-size: 16px;
      font-weight: 700;
      color: var(--navy);
      margin-bottom: 20px;
    }

    .hiw-steps {
      display: flex;
      flex-direction: column;
      gap: 16px;
    }

    .hiw-step {
      display: flex;
      align-items: center;
      gap: 14px;
    }

    .hiw-number {
      width: 32px;
      height: 32px;
      background: var(--gold);
      color: var(--navy);
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 14px;
      font-weight: 700;
      flex-shrink: 0;
    }

    .hiw-text {
      font-size: 14px;
      color: var(--text);
    }

    /* Form Column */
    .form-column {
      order: 1;
    }

    @media (max-width: 900px) {
      .form-column {
        order: 2;
      }
    }

    /* Progress Steps */
    .progress-container {
      margin-bottom: 24px;
    }

    .progress-steps {
      display: flex;
      justify-content: space-between;
      position: relative;
    }

    .progress-steps::before {
      content: '';
      position: absolute;
      top: 16px;
      left: 50px;
      right: 50px;
      height: 2px;
      background: var(--border);
    }

    .progress-step {
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 6px;
      position: relative;
      z-index: 1;
    }

    .step-circle {
      width: 32px;
      height: 32px;
      border-radius: 50%;
      background: var(--bg);
      border: 2px solid var(--border);
      display: flex;
      align-items: center;
      justify-content: center;
      font-weight: 700;
      font-size: 13px;
      color: var(--text-muted);
      transition: all 0.3s ease;
    }

    .progress-step.active .step-circle {
      border-color: var(--gold);
      background: var(--gold);
      color: var(--navy);
    }

    .progress-step.completed .step-circle {
      border-color: var(--success);
      background: var(--success);
      color: white;
    }

    .step-label {
      font-size: 11px;
      color: var(--text-muted);
      font-weight: 500;
    }

    .progress-step.active .step-label,
    .progress-step.completed .step-label {
      color: var(--text);
    }

    /* Form Card */
    .form-card {
      background: var(--bg);
      border: 1px solid var(--border);
      border-radius: 20px;
      padding: 32px;
      box-shadow: 0 4px 20px rgba(0, 0, 0, 0.04);
    }

    @media (max-width: 500px) {
      .form-card {
        padding: 24px 20px;
      }
    }

    .form-step {
      display: none;
    }

    .form-step.active {
      display: block;
      animation: fadeIn 0.3s ease;
    }

    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(10px); }
      to { opacity: 1; transform: translateY(0); }
    }

    .step-header {
      margin-bottom: 24px;
    }

    .step-title {
      font-size: 22px;
      font-weight: 700;
      color: var(--navy);
      margin-bottom: 6px;
    }

    .step-description {
      font-size: 14px;
      color: var(--text-secondary);
    }

    /* Company Type Cards */
    .type-grid {
      display: grid;
      grid-template-columns: repeat(2, 1fr);
      gap: 12px;
      margin-bottom: 20px;
    }

    @media (max-width: 400px) {
      .type-grid {
        grid-template-columns: 1fr;
      }
    }

    .type-card {
      position: relative;
      cursor: pointer;
    }

    .type-card input {
      position: absolute;
      opacity: 0;
      pointer-events: none;
    }

    .type-card-inner {
      background: var(--bg-secondary);
      border: 2px solid var(--border);
      border-radius: 14px;
      padding: 18px 14px;
      text-align: center;
      transition: all 0.2s ease;
    }

    .type-card:hover .type-card-inner {
      border-color: var(--text-muted);
    }

    .type-card input:checked + .type-card-inner {
      border-color: var(--gold);
      background: rgba(249, 203, 0, 0.08);
    }

    .type-icon {
      font-size: 28px;
      margin-bottom: 8px;
    }

    .type-name {
      font-size: 14px;
      font-weight: 600;
      color: var(--navy);
      margin-bottom: 2px;
    }

    .type-desc {
      font-size: 11px;
      color: var(--text-muted);
    }

    /* Form Fields */
    .form-grid {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 16px;
    }

    @media (max-width: 500px) {
      .form-grid {
        grid-template-columns: 1fr;
      }
    }

    .form-group {
      margin-bottom: 16px;
    }

    .form-group.full-width {
      grid-column: 1 / -1;
    }

    .form-label {
      display: block;
      font-size: 13px;
      font-weight: 600;
      color: var(--text);
      margin-bottom: 6px;
    }

    .form-label .required {
      color: var(--error);
      margin-left: 2px;
    }

    .form-input, .form-select, .form-textarea {
      width: 100%;
      padding: 12px 14px;
      background: var(--bg);
      border: 1px solid var(--border);
      border-radius: 10px;
      color: var(--text);
      font-size: 15px;
      font-family: inherit;
      transition: all 0.2s ease;
    }

    .form-input:focus, .form-select:focus, .form-textarea:focus {
      outline: none;
      border-color: var(--gold);
      box-shadow: 0 0 0 3px var(--gold-glow);
    }

    .form-input::placeholder, .form-textarea::placeholder {
      color: var(--text-muted);
    }

    .form-select {
      appearance: none;
      background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='12' height='12' viewBox='0 0 12 12'%3E%3Cpath fill='%2364748b' d='M6 8L1 3h10z'/%3E%3C/svg%3E");
      background-repeat: no-repeat;
      background-position: right 14px center;
      padding-right: 40px;
    }

    /* Checkbox Grid */
    .checkbox-grid {
      display: grid;
      grid-template-columns: repeat(3, 1fr);
      gap: 8px;
    }

    @media (max-width: 500px) {
      .checkbox-grid {
        grid-template-columns: repeat(2, 1fr);
      }
    }

    .checkbox-item {
      display: flex;
      align-items: center;
      gap: 8px;
      padding: 10px 12px;
      background: var(--bg-secondary);
      border: 1px solid var(--border);
      border-radius: 8px;
      cursor: pointer;
      transition: all 0.2s ease;
    }

    .checkbox-item:hover {
      border-color: var(--text-muted);
    }

    .checkbox-item input {
      width: 16px;
      height: 16px;
      accent-color: var(--gold);
    }

    .checkbox-item input:checked + span {
      color: var(--navy);
      font-weight: 500;
    }

    .checkbox-item span {
      font-size: 13px;
      color: var(--text-secondary);
    }

    /* Commission Box */
    .commission-box {
      background: var(--bg-tertiary);
      border: 2px solid var(--gold);
      border-radius: 14px;
      padding: 20px;
      margin: 20px 0;
      text-align: center;
    }

    .commission-label {
      font-size: 13px;
      color: var(--text-secondary);
      margin-bottom: 4px;
    }

    .commission-value {
      font-size: 40px;
      font-weight: 800;
      color: var(--navy);
    }

    .commission-value span {
      font-size: 20px;
    }

    .commission-note {
      font-size: 13px;
      color: var(--text-secondary);
      margin-top: 4px;
    }

    /* Buttons */
    .button-row {
      display: flex;
      gap: 12px;
      margin-top: 24px;
    }

    .btn {
      display: inline-flex;
      align-items: center;
      justify-content: center;
      gap: 8px;
      padding: 14px 28px;
      border-radius: 10px;
      font-size: 15px;
      font-weight: 700;
      font-family: inherit;
      cursor: pointer;
      transition: all 0.2s ease;
      border: none;
      text-decoration: none;
      flex: 1;
    }

    .btn-primary {
      background: linear-gradient(135deg, var(--gold) 0%, var(--gold-dark) 100%);
      color: var(--navy);
      box-shadow: 0 4px 15px var(--gold-glow);
    }

    .btn-primary:hover {
      transform: translateY(-2px);
      box-shadow: 0 6px 20px var(--gold-glow);
    }

    .btn-primary:disabled {
      opacity: 0.5;
      cursor: not-allowed;
      transform: none;
    }

    .btn-secondary {
      background: var(--bg);
      color: var(--text);
      border: 1px solid var(--border);
    }

    .btn-secondary:hover {
      background: var(--bg-secondary);
    }

    /* Loading Spinner */
    .loading-spinner {
      width: 18px;
      height: 18px;
      border: 2px solid var(--navy);
      border-top-color: transparent;
      border-radius: 50%;
      animation: spin 0.8s linear infinite;
    }

    @keyframes spin {
      to { transform: rotate(360deg); }
    }

    /* Success State */
    .success-state {
      text-align: center;
      padding: 32px 16px;
    }

    .success-icon {
      width: 80px;
      height: 80px;
      background: var(--success);
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      margin: 0 auto 24px;
    }

    .success-icon svg {
      width: 40px;
      height: 40px;
      stroke: white;
    }

    .success-title {
      font-size: 24px;
      font-weight: 700;
      color: var(--navy);
      margin-bottom: 12px;
    }

    .success-text {
      font-size: 15px;
      color: var(--text-secondary);
      margin-bottom: 28px;
      line-height: 1.6;
    }

    .next-steps {
      background: var(--bg-secondary);
      border-radius: 14px;
      padding: 20px;
      text-align: left;
      margin-top: 24px;
    }

    .next-steps h4 {
      font-size: 15px;
      font-weight: 700;
      color: var(--navy);
      margin-bottom: 14px;
    }

    .next-step-item {
      display: flex;
      align-items: center;
      gap: 12px;
      margin-bottom: 10px;
      font-size: 14px;
      color: var(--text-secondary);
    }

    .next-step-item:last-child {
      margin-bottom: 0;
    }

    .step-number-sm {
      width: 22px;
      height: 22px;
      background: var(--gold);
      color: var(--navy);
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 11px;
      font-weight: 700;
      flex-shrink: 0;
    }

    /* Alert */
    .alert {
      padding: 12px 14px;
      border-radius: 10px;
      font-size: 14px;
      margin-bottom: 16px;
      display: none;
    }

    .alert.show {
      display: block;
    }

    .alert-error {
      background: rgba(239, 68, 68, 0.1);
      border: 1px solid rgba(239, 68, 68, 0.3);
      color: #dc2626;
    }

    /* Login Link */
    .login-link {
      text-align: center;
      margin-top: 20px;
      font-size: 14px;
      color: var(--text-secondary);
    }

    .login-link a {
      color: var(--navy);
      text-decoration: none;
      font-weight: 600;
    }

    .login-link a:hover {
      text-decoration: underline;
    }

    /* Terms */
    .terms-text {
      font-size: 12px;
      color: var(--text-muted);
      text-align: center;
      margin-top: 16px;
      line-height: 1.6;
    }

    .terms-text a {
      color: var(--text-secondary);
      text-decoration: underline;
    }

    /* Leaflet overrides for light theme */
    .leaflet-container {
      background: var(--bg-secondary);
    }
  </style>
</head>

<body>
  <!-- Hero Section -->
  <section class="hero-section">
    <div class="hero-map-bg">
      <div id="heroMap"></div>
    </div>

    <div class="hero-content">
      <div class="hero-text">
        <div class="hero-badge">
          <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M21 10c0 7-9 13-9 13s-9-6-9-13a9 9 0 0 1 18 0z"/>
            <circle cx="12" cy="10" r="3"/>
          </svg>
          STONE YARDS NETWORK
        </div>
        <h1 class="hero-title">Get Your Stone <span>On the Map</span></h1>
        <p class="hero-subtitle">Join our interactive Stone Yards directory. Whether you're a distributor, fabricator with a bone yard, or anyone with slabs to sell - get featured and reach thousands of buyers in Arizona.</p>

        <div class="hero-stats">
          <div class="hero-stat">
            <div class="hero-stat-value">10K+</div>
            <div class="hero-stat-label">Monthly Visitors</div>
          </div>
          <div class="hero-stat">
            <div class="hero-stat-value">Free</div>
            <div class="hero-stat-label">To Join</div>
          </div>
          <div class="hero-stat">
            <div class="hero-stat-value">5%</div>
            <div class="hero-stat-label">Commission Only</div>
          </div>
        </div>
      </div>

      <div class="hero-preview">
        <div class="preview-header">
          <div class="preview-icon">üìç</div>
          <div>
            <div class="preview-title">Your Listing Preview</div>
            <div class="preview-subtitle">How you'll appear on the map</div>
          </div>
        </div>
        <div class="preview-map">
          <div id="previewMapEl"></div>
        </div>
        <div class="preview-features">
          <div class="preview-feature">
            <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5"><path d="M20 6L9 17l-5-5"/></svg>
            <span>Pin on interactive map</span>
          </div>
          <div class="preview-feature">
            <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5"><path d="M20 6L9 17l-5-5"/></svg>
            <span>Business profile page</span>
          </div>
          <div class="preview-feature">
            <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5"><path d="M20 6L9 17l-5-5"/></svg>
            <span>Direct customer inquiries</span>
          </div>
          <div class="preview-feature">
            <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5"><path d="M20 6L9 17l-5-5"/></svg>
            <span>Inventory listings</span>
          </div>
        </div>
      </div>
    </div>
  </section>

  <div class="signup-container">
    <div class="content-grid">
      <!-- Form Column -->
      <div class="form-column">
        <!-- Progress Steps -->
        <div class="progress-container">
          <div class="progress-steps">
            <div class="progress-step active" data-step="1">
              <div class="step-circle">1</div>
              <span class="step-label">Business</span>
            </div>
            <div class="progress-step" data-step="2">
              <div class="step-circle">2</div>
              <span class="step-label">Inventory</span>
            </div>
            <div class="progress-step" data-step="3">
              <div class="step-circle">3</div>
              <span class="step-label">Location</span>
            </div>
            <div class="progress-step" data-step="4">
              <div class="step-circle">4</div>
              <span class="step-label">Account</span>
            </div>
          </div>
        </div>

        <div class="form-card">
          <div class="alert alert-error" id="errorAlert"></div>

          <!-- Step 1: Business Type -->
          <div class="form-step active" data-step="1">
            <div class="step-header">
              <h2 class="step-title">What describes your business?</h2>
              <p class="step-description">Select the option that best fits - you can sell stone through any of these.</p>
            </div>

            <div class="type-grid">
              <label class="type-card">
                <input type="radio" name="company_type" value="distributor" required>
                <div class="type-card-inner">
                  <div class="type-icon">üè¢</div>
                  <div class="type-name">Distributor</div>
                  <div class="type-desc">Stone & tile distribution</div>
                </div>
              </label>

              <label class="type-card">
                <input type="radio" name="company_type" value="bone_yard">
                <div class="type-card-inner">
                  <div class="type-icon">ü¶¥</div>
                  <div class="type-name">Bone Yard</div>
                  <div class="type-desc">Remnants & surplus stone</div>
                </div>
              </label>

              <label class="type-card">
                <input type="radio" name="company_type" value="fabricator_yard">
                <div class="type-card-inner">
                  <div class="type-icon">‚öôÔ∏è</div>
                  <div class="type-name">Fabricator w/ Yard</div>
                  <div class="type-desc">Fab shop with slab inventory</div>
                </div>
              </label>

              <label class="type-card">
                <input type="radio" name="company_type" value="stone_yard">
                <div class="type-card-inner">
                  <div class="type-icon">ü™®</div>
                  <div class="type-name">Stone Yard</div>
                  <div class="type-desc">Retail stone supplier</div>
                </div>
              </label>

              <label class="type-card">
                <input type="radio" name="company_type" value="wholesaler">
                <div class="type-card-inner">
                  <div class="type-icon">üì¶</div>
                  <div class="type-name">Wholesaler</div>
                  <div class="type-desc">Wholesale trade only</div>
                </div>
              </label>

              <label class="type-card">
                <input type="radio" name="company_type" value="importer">
                <div class="type-card-inner">
                  <div class="type-icon">üö¢</div>
                  <div class="type-name">Importer / Quarry</div>
                  <div class="type-desc">Direct from source</div>
                </div>
              </label>
            </div>

            <div class="button-row">
              <button type="button" class="btn btn-primary" onclick="nextStep(1)">
                Continue
                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5">
                  <path d="M5 12h14M12 5l7 7-7 7"/>
                </svg>
              </button>
            </div>
          </div>

          <!-- Step 2: Products & Materials -->
          <div class="form-step" data-step="2">
            <div class="step-header">
              <h2 class="step-title">What stone do you carry?</h2>
              <p class="step-description">Select all materials you have available for sale.</p>
            </div>

            <div class="form-group">
              <label class="form-label">Material Types <span class="required">*</span></label>
              <div class="checkbox-grid">
                <label class="checkbox-item">
                  <input type="checkbox" name="materials" value="granite">
                  <span>Granite</span>
                </label>
                <label class="checkbox-item">
                  <input type="checkbox" name="materials" value="quartz">
                  <span>Quartz</span>
                </label>
                <label class="checkbox-item">
                  <input type="checkbox" name="materials" value="marble">
                  <span>Marble</span>
                </label>
                <label class="checkbox-item">
                  <input type="checkbox" name="materials" value="quartzite">
                  <span>Quartzite</span>
                </label>
                <label class="checkbox-item">
                  <input type="checkbox" name="materials" value="porcelain">
                  <span>Porcelain</span>
                </label>
                <label class="checkbox-item">
                  <input type="checkbox" name="materials" value="soapstone">
                  <span>Soapstone</span>
                </label>
                <label class="checkbox-item">
                  <input type="checkbox" name="materials" value="travertine">
                  <span>Travertine</span>
                </label>
                <label class="checkbox-item">
                  <input type="checkbox" name="materials" value="onyx">
                  <span>Onyx</span>
                </label>
                <label class="checkbox-item">
                  <input type="checkbox" name="materials" value="other">
                  <span>Other</span>
                </label>
              </div>
            </div>

            <div class="form-group" style="margin-top: 20px;">
              <label class="form-label">Approximate Inventory</label>
              <select class="form-input form-select" id="inventorySize" name="inventory_size">
                <option value="">Select range...</option>
                <option value="1-25">1-25 slabs / remnants</option>
                <option value="25-100">25-100 pieces</option>
                <option value="100-500">100-500 pieces</option>
                <option value="500-1000">500-1,000 pieces</option>
                <option value="1000+">1,000+ pieces</option>
              </select>
            </div>

            <div class="button-row">
              <button type="button" class="btn btn-secondary" onclick="prevStep(2)">Back</button>
              <button type="button" class="btn btn-primary" onclick="nextStep(2)">Continue</button>
            </div>
          </div>

          <!-- Step 3: Location -->
          <div class="form-step" data-step="3">
            <div class="step-header">
              <h2 class="step-title">Where is your yard located?</h2>
              <p class="step-description">This is where customers will visit to view stone.</p>
            </div>

            <div class="form-grid">
              <div class="form-group full-width">
                <label class="form-label">Business Name <span class="required">*</span></label>
                <input type="text" class="form-input" id="companyName" name="company_name" placeholder="Your Company Name" required>
              </div>

              <div class="form-group full-width">
                <label class="form-label">Street Address <span class="required">*</span></label>
                <input type="text" class="form-input" id="address" name="address" placeholder="123 Stone Way" required>
              </div>

              <div class="form-group">
                <label class="form-label">City <span class="required">*</span></label>
                <input type="text" class="form-input" id="city" name="city" placeholder="Phoenix" required>
              </div>

              <div class="form-group">
                <label class="form-label">State</label>
                <select class="form-input form-select" id="state" name="state">
                  <option value="AZ" selected>Arizona</option>
                  <option value="CA">California</option>
                  <option value="NV">Nevada</option>
                  <option value="NM">New Mexico</option>
                  <option value="TX">Texas</option>
                  <option value="CO">Colorado</option>
                  <option value="UT">Utah</option>
                </select>
              </div>

              <div class="form-group">
                <label class="form-label">ZIP Code <span class="required">*</span></label>
                <input type="text" class="form-input" id="zipCode" name="zip_code" placeholder="85001" required pattern="[0-9]{5}" inputmode="numeric">
              </div>

              <div class="form-group">
                <label class="form-label">Phone</label>
                <input type="tel" class="form-input" id="yardPhone" name="yard_phone" placeholder="(602) 555-1234">
              </div>

              <div class="form-group full-width">
                <label class="form-label">Website</label>
                <input type="url" class="form-input" id="website" name="website" placeholder="https://www.yourcompany.com">
              </div>
            </div>

            <div class="button-row">
              <button type="button" class="btn btn-secondary" onclick="prevStep(3)">Back</button>
              <button type="button" class="btn btn-primary" onclick="nextStep(3)">Continue</button>
            </div>
          </div>

          <!-- Step 4: Account -->
          <div class="form-step" data-step="4">
            <div class="step-header">
              <h2 class="step-title">Create your account</h2>
              <p class="step-description">Set up your login to manage your listing.</p>
            </div>

            <div class="form-grid">
              <div class="form-group">
                <label class="form-label">Contact Name <span class="required">*</span></label>
                <input type="text" class="form-input" id="contactName" name="contact_name" placeholder="John Smith" required>
              </div>

              <div class="form-group">
                <label class="form-label">Phone <span class="required">*</span></label>
                <input type="tel" class="form-input" id="phone" name="phone" placeholder="(602) 555-1234" required>
              </div>

              <div class="form-group full-width">
                <label class="form-label">Email <span class="required">*</span></label>
                <input type="email" class="form-input" id="email" name="email" placeholder="you@company.com" required>
              </div>

              <div class="form-group full-width">
                <label class="form-label">Password <span class="required">*</span></label>
                <input type="password" class="form-input" id="password" name="password" placeholder="Min 8 characters" required minlength="8">
              </div>
            </div>

            <div class="commission-box">
              <div class="commission-label">Marketplace Commission</div>
              <div class="commission-value">5<span>%</span></div>
              <div class="commission-note">Only on sales through our platform. No monthly fees.</div>
            </div>

            <div class="button-row">
              <button type="button" class="btn btn-secondary" onclick="prevStep(4)">Back</button>
              <button type="button" class="btn btn-primary" id="submitBtn" onclick="submitSignup()">
                Create Account
              </button>
            </div>

            <p class="terms-text">
              By creating an account, you agree to our <a href="/legal/terms-of-use/">Terms</a>, <a href="/legal/privacy-policy/">Privacy Policy</a>, and <a href="/legal/distributor-agreement/">Partner Agreement</a>.
            </p>
          </div>

          <!-- Success State -->
          <div class="form-step" data-step="success">
            <div class="success-state">
              <div class="success-icon">
                <svg viewBox="0 0 24 24" fill="none" stroke-width="2.5"><path d="M20 6L9 17l-5-5"/></svg>
              </div>
              <h2 class="success-title">You're on the Map!</h2>
              <p class="success-text">
                Your Stone Yards listing has been created. Verify your email, then log in to add inventory and customize your profile.
              </p>

              <a href="/log-in/?redirect=/distributor/dashboard/" class="btn btn-primary" style="width: 100%; margin-bottom: 12px;">
                Log In to Dashboard
                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5">
                  <path d="M5 12h14M12 5l7 7-7 7"/>
                </svg>
              </a>

              <div class="next-steps">
                <h4>Next Steps:</h4>
                <div class="next-step-item">
                  <span class="step-number-sm">1</span>
                  <span>Verify your email (check inbox)</span>
                </div>
                <div class="next-step-item">
                  <span class="step-number-sm">2</span>
                  <span>Add photos of your yard</span>
                </div>
                <div class="next-step-item">
                  <span class="step-number-sm">3</span>
                  <span>Upload your slab inventory</span>
                </div>
                <div class="next-step-item">
                  <span class="step-number-sm">4</span>
                  <span>Set business hours & directions</span>
                </div>
              </div>
            </div>
          </div>
        </div>

        <div class="login-link">
          Already have an account? <a href="/log-in/?redirect=/distributor/dashboard/">Log in</a>
        </div>
      </div>

      <!-- Benefits Column -->
      <div class="benefits-column">
        <h3 class="benefits-title">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M12 2L2 7l10 5 10-5-10-5z"/>
            <path d="M2 17l10 5 10-5"/>
            <path d="M2 12l10 5 10-5"/>
          </svg>
          Why Join Stone Yards?
        </h3>

        <div class="benefit-list">
          <div class="benefit-item">
            <div class="benefit-icon">üìç</div>
            <div class="benefit-content">
              <h4>Featured on Our Map</h4>
              <p>Your location appears on our interactive Stone Yards map that thousands of buyers browse monthly.</p>
            </div>
          </div>

          <div class="benefit-item">
            <div class="benefit-icon">üîÑ</div>
            <div class="benefit-content">
              <h4>Mutual Referral System</h4>
              <p>Send your customers to us for fabrication - we send our customers to you for slab selection.</p>
            </div>
          </div>

          <div class="benefit-item">
            <div class="benefit-icon">üí∞</div>
            <div class="benefit-content">
              <h4>Move Remnants Fast</h4>
              <p>Bone yard pieces, remnants, and surplus slabs find buyers through our marketplace.</p>
            </div>
          </div>

          <div class="benefit-item">
            <div class="benefit-icon">üìä</div>
            <div class="benefit-content">
              <h4>Analytics Dashboard</h4>
              <p>Track views, inquiries, and sales. Know which materials are in demand.</p>
            </div>
          </div>
        </div>

        <div class="how-it-works">
          <h4 class="hiw-title">How It Works</h4>
          <div class="hiw-steps">
            <div class="hiw-step">
              <div class="hiw-number">1</div>
              <div class="hiw-text">Sign up free and add your location</div>
            </div>
            <div class="hiw-step">
              <div class="hiw-number">2</div>
              <div class="hiw-text">Upload your slab & remnant inventory</div>
            </div>
            <div class="hiw-step">
              <div class="hiw-number">3</div>
              <div class="hiw-text">Customers find you on our map</div>
            </div>
            <div class="hiw-step">
              <div class="hiw-number">4</div>
              <div class="hiw-text">Get direct inquiries & make sales</div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <script>
    // Supabase Config
    const SUPABASE_URL = 'https://ypeypgwsycxcagncgdur.supabase.co';
    const SUPABASE_ANON_KEY = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InlwZXlwZ3dzeWN4Y2FnbmNnZHVyIiwicm9sZSI6ImFub24iLCJpYXQiOjE3Njc3NTQ4MjMsImV4cCI6MjA4MzMzMDgyM30.R13pNv2FDtGhfeu7gUcttYNrQAbNYitqR4FIq3O2-ME';
    const supabaseClient = window.supabase.createClient(SUPABASE_URL, SUPABASE_ANON_KEY);

    let currentStep = 1;
    let formData = {};
    const isLocalhost = window.location.hostname === 'localhost' || window.location.hostname === '127.0.0.1';

    // Initialize maps
    document.addEventListener('DOMContentLoaded', function() {
      // Hero background map (decorative)
      try {
        const heroMap = L.map('heroMap', {
          zoomControl: false,
          dragging: false,
          scrollWheelZoom: false,
          doubleClickZoom: false,
          attributionControl: false
        }).setView([33.5, -112.0], 9);

        L.tileLayer('https://{s}.basemaps.cartocdn.com/light_all/{z}/{x}/{y}{r}.png', {
          maxZoom: 19
        }).addTo(heroMap);
      } catch(e) {}

      // Preview map
      try {
        const previewMap = L.map('previewMapEl', {
          zoomControl: false,
          dragging: false,
          scrollWheelZoom: false,
          attributionControl: false
        }).setView([33.45, -112.07], 11);

        L.tileLayer('https://{s}.basemaps.cartocdn.com/light_all/{z}/{x}/{y}{r}.png', {
          maxZoom: 19
        }).addTo(previewMap);

        // Add sample pin
        const goldIcon = L.divIcon({
          className: 'custom-pin',
          html: `<div style="
            width: 32px;
            height: 32px;
            background: linear-gradient(135deg, #f9cb00 0%, #d4a900 100%);
            border-radius: 50% 50% 50% 0;
            transform: rotate(-45deg);
            border: 3px solid white;
            box-shadow: 0 3px 10px rgba(0,0,0,0.3);
            display: flex;
            align-items: center;
            justify-content: center;
          "><span style="transform: rotate(45deg); font-size: 14px;">üìç</span></div>`,
          iconSize: [32, 32],
          iconAnchor: [16, 32]
        });

        L.marker([33.45, -112.07], { icon: goldIcon }).addTo(previewMap);
      } catch(e) {}

      // Check URL params for pre-selection
      const urlParams = new URLSearchParams(window.location.search);
      const partnerType = urlParams.get('type') || urlParams.get('partner');
      if (partnerType) {
        const typeMap = {
          'stone-yard': 'stone_yard',
          'bone-yard': 'bone_yard',
          'boneyard': 'bone_yard',
          'fabricator': 'fabricator_yard',
          'distributor': 'distributor',
          'wholesaler': 'wholesaler',
          'importer': 'importer'
        };
        const mappedType = typeMap[partnerType.toLowerCase()] || partnerType.replace(/-/g, '_');
        const radio = document.querySelector(`input[name="company_type"][value="${mappedType}"]`);
        if (radio) radio.checked = true;
      }
    });

    // Phone formatting
    document.querySelectorAll('input[type="tel"]').forEach(input => {
      input.addEventListener('input', function(e) {
        let value = e.target.value.replace(/\D/g, '');
        if (value.length >= 6) {
          value = '(' + value.substring(0,3) + ') ' + value.substring(3,6) + '-' + value.substring(6,10);
        } else if (value.length >= 3) {
          value = '(' + value.substring(0,3) + ') ' + value.substring(3);
        }
        e.target.value = value;
      });
    });

    function showError(message) {
      const alert = document.getElementById('errorAlert');
      alert.textContent = message;
      alert.classList.add('show');
      setTimeout(() => alert.classList.remove('show'), 5000);
    }

    function validateStep(step) {
      if (step === 1) {
        const companyType = document.querySelector('input[name="company_type"]:checked');
        if (!companyType) {
          showError('Please select your business type');
          return false;
        }
        formData.company_type = companyType.value;
        return true;
      }

      if (step === 2) {
        const materials = Array.from(document.querySelectorAll('input[name="materials"]:checked')).map(cb => cb.value);
        if (materials.length === 0) {
          showError('Please select at least one material type');
          return false;
        }
        formData.material_types = materials;
        formData.inventory_size = document.getElementById('inventorySize').value;
        return true;
      }

      if (step === 3) {
        const companyName = document.getElementById('companyName').value.trim();
        const address = document.getElementById('address').value.trim();
        const city = document.getElementById('city').value.trim();
        const state = document.getElementById('state').value;
        const zipCode = document.getElementById('zipCode').value.trim();

        if (!companyName) {
          showError('Please enter your business name');
          return false;
        }
        if (!address) {
          showError('Please enter your street address');
          return false;
        }
        if (!city) {
          showError('Please enter your city');
          return false;
        }
        if (!/^\d{5}$/.test(zipCode)) {
          showError('Please enter a valid 5-digit ZIP code');
          return false;
        }

        formData.company_name = companyName;
        formData.address = address;
        formData.city = city;
        formData.state = state;
        formData.zip_code = zipCode;
        formData.yard_phone = document.getElementById('yardPhone').value.trim();
        formData.website = document.getElementById('website').value.trim();
        return true;
      }

      if (step === 4) {
        const contactName = document.getElementById('contactName').value.trim();
        const phone = document.getElementById('phone').value.trim();
        const email = document.getElementById('email').value.trim();
        const password = document.getElementById('password').value;

        if (!contactName) {
          showError('Please enter your name');
          return false;
        }
        if (phone.replace(/\D/g, '').length < 10) {
          showError('Please enter a valid phone number');
          return false;
        }
        if (!email.includes('@') || !email.includes('.')) {
          showError('Please enter a valid email');
          return false;
        }
        if (password.length < 8) {
          showError('Password must be at least 8 characters');
          return false;
        }

        formData.contact_name = contactName;
        formData.phone = phone;
        formData.email = email;
        formData.password = password;
        return true;
      }

      return true;
    }

    function nextStep(fromStep) {
      if (!validateStep(fromStep)) return;
      currentStep = fromStep + 1;
      updateStepDisplay();
    }

    function prevStep(fromStep) {
      currentStep = fromStep - 1;
      updateStepDisplay();
    }

    function updateStepDisplay() {
      document.querySelectorAll('.form-step').forEach(step => {
        step.classList.remove('active');
      });

      const currentStepEl = document.querySelector(`.form-step[data-step="${currentStep}"]`);
      if (currentStepEl) {
        currentStepEl.classList.add('active');
      }

      document.querySelectorAll('.progress-step').forEach(step => {
        const stepNum = parseInt(step.dataset.step);
        step.classList.remove('active', 'completed');
        if (stepNum < currentStep) {
          step.classList.add('completed');
        } else if (stepNum === currentStep) {
          step.classList.add('active');
        }
      });

      document.querySelector('.form-card').scrollIntoView({ behavior: 'smooth', block: 'start' });
    }

    async function submitSignup() {
      if (!validateStep(4)) return;

      const submitBtn = document.getElementById('submitBtn');
      submitBtn.disabled = true;
      submitBtn.innerHTML = '<div class="loading-spinner"></div> Creating...';

      // Demo mode
      if (isLocalhost) {
        console.log('Demo mode: Simulating signup with data:', formData);
        await new Promise(resolve => setTimeout(resolve, 1500));
        document.querySelectorAll('.form-step').forEach(step => step.classList.remove('active'));
        document.querySelector('.form-step[data-step="success"]').classList.add('active');
        document.querySelectorAll('.progress-step').forEach(step => step.classList.add('completed'));
        return;
      }

      try {
        // 1. Create auth user
        const { data: authData, error: authError } = await supabaseClient.auth.signUp({
          email: formData.email,
          password: formData.password,
          options: {
            data: {
              full_name: formData.contact_name,
              account_type: 'distributor',
              company_name: formData.company_name
            }
          }
        });

        if (authError) throw authError;

        const hasSession = authData.session !== null;

        // 2. Create distributor profile
        const { data: profileData, error: profileError } = await supabaseClient
          .from('distributor_profiles')
          .insert({
            user_id: authData.user.id,
            company_name: formData.company_name,
            company_type: formData.company_type,
            primary_contact_name: formData.contact_name,
            primary_contact_email: formData.email,
            primary_contact_phone: formData.phone,
            website: formData.website || null,
            material_types: formData.material_types,
            service_regions: [formData.state],
            onboarding_step: 4
          })
          .select()
          .single();

        if (profileError) {
          console.error('Profile error:', profileError);
        }

        // 3. Create location
        if (profileData) {
          await supabaseClient
            .from('distributor_locations')
            .insert({
              distributor_id: profileData.id,
              location_name: formData.company_name + ' - ' + formData.city,
              location_type: 'slab_yard',
              is_primary: true,
              address_line1: formData.address,
              city: formData.city,
              state: formData.state,
              zip_code: formData.zip_code,
              phone: formData.yard_phone || formData.phone,
              email: formData.email
            });
        }

        // 4. Store for dashboard
        localStorage.setItem('sg_distributor_signup', JSON.stringify({
          distributor_id: profileData?.id || authData.user.id,
          email: formData.email,
          company_name: formData.company_name
        }));

        // 5. Redirect or show success
        if (hasSession) {
          window.location.href = '/distributor/dashboard/';
          return;
        }

        document.querySelectorAll('.form-step').forEach(step => step.classList.remove('active'));
        document.querySelector('.form-step[data-step="success"]').classList.add('active');
        document.querySelectorAll('.progress-step').forEach(step => step.classList.add('completed'));

      } catch (error) {
        console.error('Signup error:', error);
        showError(error.message || 'Something went wrong. Please try again.');
        submitBtn.disabled = false;
        submitBtn.innerHTML = 'Create Account';
      }
    }
  </script>
<script defer src="/js/remodely-hub.js?v=20260118"></script>
</body>
</html>
