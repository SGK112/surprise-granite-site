<!-- Scripts Component - Surprise Granite -->
<script src="https://d3e54v103j8qbb.cloudfront.net/js/jquery-3.5.1.min.dc5e7f18c8.js" type="text/javascript" crossorigin="anonymous"></script>
<script src="https://cdn.prod.website-files.com/6456ce4476abb25581fbad0c/js/webflow.schunk.59c6248219f37ae8.js" type="text/javascript"></script>
<script src="https://cdn.prod.website-files.com/6456ce4476abb25581fbad0c/js/webflow.schunk.55b1d870bd166d43.js" type="text/javascript"></script>
<script src="https://cdn.prod.website-files.com/6456ce4476abb25581fbad0c/js/webflow.741b4ac7.a2dfb666f301e88a.js" type="text/javascript"></script>

<!-- Bold Navbar Effect -->
<script src="https://cdn.prod.website-files.com/6456ce4476abb25581fbad0c%2F689e5ba67671442434f3ca35%2F68e5e3cb282ad3bfc564547a%2Fbold_navbar_effect-2.0.0.js" type="text/javascript"></script>

<!-- Calculator Widget -->
<style>
.sg-widget {
    --widget-bg: rgba(255, 255, 255, 0.72);
    --widget-border: rgba(0, 0, 0, 0.06);
    --widget-shadow: 0 8px 32px rgba(0, 0, 0, 0.12), 0 2px 8px rgba(0, 0, 0, 0.04);
    --icon-bg: #18181b;
    --icon-color: #fbbf24;
    --text-primary: #18181b;
    --text-secondary: #71717a;
    position: fixed;
    bottom: 24px;
    left: 24px;
    z-index: 99998;
    font-family: -apple-system, BlinkMacSystemFont, 'SF Pro Text', 'Inter', system-ui, sans-serif;
    -webkit-font-smoothing: antialiased;
    transform: translateX(-120%);
    opacity: 0;
    transition: transform 0.4s cubic-bezier(0.4, 0, 0.2, 1), opacity 0.4s ease;
}
.sg-widget.visible { transform: translateX(0); opacity: 1; }
.sg-widget.hidden { transform: translateX(-120%); opacity: 0; }
.sg-widget-btn {
    display: flex;
    align-items: center;
    gap: 12px;
    padding: 6px;
    padding-right: 18px;
    background: var(--widget-bg);
    backdrop-filter: blur(24px) saturate(180%);
    -webkit-backdrop-filter: blur(24px) saturate(180%);
    border: 1px solid var(--widget-border);
    border-radius: 56px;
    box-shadow: var(--widget-shadow);
    text-decoration: none;
    cursor: pointer;
    transition: transform 0.2s ease, box-shadow 0.2s ease;
}
.sg-widget-btn:hover { transform: translateY(-2px); box-shadow: 0 12px 40px rgba(0, 0, 0, 0.15); }
.sg-widget-icon {
    display: grid;
    place-items: center;
    width: 44px;
    height: 44px;
    background: var(--icon-bg);
    border-radius: 50%;
    flex-shrink: 0;
}
.sg-widget-icon svg { width: 20px; height: 20px; color: var(--icon-color); }
.sg-widget-content { display: flex; flex-direction: column; gap: 1px; }
.sg-widget-eyebrow { font-size: 10px; font-weight: 500; letter-spacing: 0.5px; text-transform: uppercase; color: var(--text-secondary); }
.sg-widget-label { font-size: 14px; font-weight: 600; letter-spacing: -0.2px; color: var(--text-primary); }
.sg-widget-card {
    position: absolute;
    bottom: calc(100% + 12px);
    left: 0;
    width: 220px;
    padding: 16px;
    background: var(--icon-bg);
    border-radius: 12px;
    opacity: 0;
    visibility: hidden;
    transform: translateY(4px);
    transition: all 0.2s ease;
    pointer-events: none;
}
.sg-widget-btn:hover .sg-widget-card { opacity: 1; visibility: visible; transform: translateY(0); }
.sg-card-title { font-size: 13px; font-weight: 600; color: #fff; margin: 0 0 12px 0; }
.sg-card-items { display: flex; flex-direction: column; gap: 8px; }
.sg-card-item { display: flex; align-items: center; gap: 8px; font-size: 12px; color: rgba(255,255,255,0.7); }
.sg-card-item svg { width: 14px; height: 14px; color: #fbbf24; flex-shrink: 0; }
@media (max-width: 640px) {
    .sg-widget { bottom: 16px; left: 16px; }
    .sg-widget-content { display: none; }
    .sg-widget-btn { padding: 0; border-radius: 50%; width: 56px; height: 56px; justify-content: center; }
    .sg-widget-icon { width: 56px; height: 56px; }
    .sg-widget-card { display: none; }
}
</style>

<div class="sg-widget" id="sgWidget">
    <a href="/tools/countertop-calculator/" class="sg-widget-btn" id="sgWidgetBtn">
        <div class="sg-widget-icon">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round">
                <rect x="4" y="2" width="16" height="20" rx="2"/>
                <path d="M8 6h8"/>
                <path d="M8 10h2v2H8z" fill="currentColor" stroke="none"/>
                <path d="M14 10h2v2h-2z" fill="currentColor" stroke="none"/>
                <path d="M8 14h2v2H8z" fill="currentColor" stroke="none"/>
                <path d="M14 14h2v2h-2z" fill="currentColor" stroke="none"/>
                <path d="M8 18h2v2H8z" fill="currentColor" stroke="none"/>
                <path d="M14 18h2v2h-2z" fill="currentColor" stroke="none"/>
            </svg>
        </div>
        <div class="sg-widget-content">
            <span class="sg-widget-eyebrow">Free Tool</span>
            <span class="sg-widget-label">Countertop Calculator</span>
        </div>
        <div class="sg-widget-card">
            <p class="sg-card-title">Quick Price Calculator</p>
            <div class="sg-card-items">
                <div class="sg-card-item">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M5 12l5 5L20 7"/></svg>
                    Enter your dimensions
                </div>
                <div class="sg-card-item">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M5 12l5 5L20 7"/></svg>
                    Add edges & backsplash
                </div>
                <div class="sg-card-item">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M5 12l5 5L20 7"/></svg>
                    Get instant pricing
                </div>
            </div>
        </div>
    </a>
</div>

<script>
(function(){
    var w=document.getElementById('sgWidget');
    if(!w)return;
    setTimeout(function(){w.classList.add('visible');},800);
    var lastY=0;
    window.addEventListener('scroll',function(){
        var y=window.scrollY;
        if(y>lastY&&y>300){w.classList.remove('visible');w.classList.add('hidden');}
        else if(y<lastY){w.classList.remove('hidden');w.classList.add('visible');}
        lastY=y;
    });
})();
</script>

<!-- SG Chat Widget -->
<style>
#sg-chat-widget { position: fixed; bottom: 24px; right: 24px; z-index: 999999; font-family: -apple-system, BlinkMacSystemFont, 'SF Pro Text', system-ui, sans-serif; }
#sg-chat-button { width: 64px; height: 64px; border-radius: 50%; background: #f9cb00; border: none; cursor: pointer; box-shadow: 0 4px 16px rgba(0,0,0,0.2); display: flex; align-items: center; justify-content: center; transition: transform 0.15s ease; outline: none; }
#sg-chat-button:active { transform: scale(0.94); }
#sg-chat-button svg { width: 32px; height: 32px; stroke: #fff; fill: none; }
#sg-chat-button .sg-icon-chat { display: block; }
#sg-chat-button .sg-icon-close { display: none; }
#sg-chat-button.active .sg-icon-chat { display: none; }
#sg-chat-button.active .sg-icon-close { display: block; }
#sg-chat-window { display: none; position: fixed; bottom: 100px; right: 24px; width: 380px; max-width: calc(100vw - 48px); height: 500px; max-height: calc(100vh - 140px); background: #fff; border-radius: 20px; box-shadow: 0 12px 48px rgba(0,0,0,0.15); flex-direction: column; overflow: hidden; z-index: 999999; }
#sg-chat-window.active { display: flex; animation: sg-slide-up 0.25s ease; }
@keyframes sg-slide-up { from { opacity: 0; transform: translateY(16px); } to { opacity: 1; transform: translateY(0); } }
.sg-chat-header { background: #f9cb00; padding: 16px; display: flex; align-items: center; justify-content: space-between; flex-shrink: 0; }
.sg-chat-header-info { display: flex; align-items: center; gap: 12px; }
.sg-chat-avatar { width: 40px; height: 40px; border-radius: 50%; overflow: hidden; background: #fff; }
.sg-chat-avatar img { width: 100%; height: 100%; object-fit: cover; }
.sg-chat-title h3 { margin: 0; font-size: 16px; font-weight: 600; color: #1a1a2e; }
.sg-chat-title p { margin: 2px 0 0; font-size: 13px; color: rgba(26,26,46,0.7); }
.sg-chat-close { width: 36px; height: 36px; border-radius: 50%; background: #1a1a2e; border: none; cursor: pointer; display: flex; align-items: center; justify-content: center; }
.sg-chat-body { flex: 1; overflow-y: auto; padding: 16px; background: #f8f9fa; display: flex; flex-direction: column; gap: 12px; }
.sg-message { max-width: 80%; padding: 12px 16px; border-radius: 18px; font-size: 15px; line-height: 1.4; word-wrap: break-word; }
.sg-message.bot { background: #fff; color: #1a1a2e; align-self: flex-start; border-bottom-left-radius: 6px; box-shadow: 0 1px 2px rgba(0,0,0,0.08); }
.sg-message.user { background: #f9cb00; color: #1a1a2e; align-self: flex-end; border-bottom-right-radius: 6px; }
.sg-typing { display: flex; gap: 5px; padding: 12px 16px; background: #fff; border-radius: 18px; border-bottom-left-radius: 6px; align-self: flex-start; }
.sg-typing span { width: 8px; height: 8px; background: #bbb; border-radius: 50%; animation: sg-bounce 1.4s infinite; }
.sg-typing span:nth-child(2) { animation-delay: 0.16s; }
.sg-typing span:nth-child(3) { animation-delay: 0.32s; }
@keyframes sg-bounce { 0%, 60%, 100% { transform: translateY(0); } 30% { transform: translateY(-6px); } }
.sg-chat-input-area { padding: 12px 16px; background: #fff; border-top: 1px solid #e9ecef; display: flex; align-items: center; gap: 12px; }
.sg-chat-input { flex: 1; height: 44px; padding: 0 16px; border: 2px solid #e9ecef; border-radius: 22px; font-size: 15px; background: #f8f9fa; color: #1a1a2e; outline: none; }
.sg-chat-input:focus { border-color: #f9cb00; background: #fff; }
.sg-send-btn { width: 44px; height: 44px; border-radius: 50%; background: #1a1a2e; border: none; cursor: pointer; display: flex; align-items: center; justify-content: center; }
.sg-send-btn:active { transform: scale(0.94); }
@media (max-width: 480px) {
  #sg-chat-widget { bottom: 20px; right: 20px; }
  #sg-chat-button { width: 60px; height: 60px; }
  #sg-chat-window { position: fixed; top: 0; left: 0; right: 0; bottom: 0; width: 100%; max-width: 100%; height: 100%; max-height: 100%; border-radius: 0; }
}
</style>

<div id="sg-chat-widget">
  <button id="sg-chat-button" aria-label="Chat with us">
    <svg class="sg-icon-chat" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
      <path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"></path>
    </svg>
    <svg class="sg-icon-close" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round">
      <line x1="18" y1="6" x2="6" y2="18"></line>
      <line x1="6" y1="6" x2="18" y2="18"></line>
    </svg>
  </button>
  <div id="sg-chat-window">
    <div class="sg-chat-header">
      <div class="sg-chat-header-info">
        <div class="sg-chat-avatar">
          <img src="https://cdn.prod.website-files.com/6456ce4476abb25581fbad0c/658d12c161cdc3543474cddc_designer-avatar-profile.jpg" alt="Assistant">
        </div>
        <div class="sg-chat-title">
          <h3>Surprise Granite</h3>
          <p>Design Assistant</p>
        </div>
      </div>
      <button class="sg-chat-close" aria-label="Close chat">
        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="#fff" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round">
          <line x1="18" y1="6" x2="6" y2="18"></line>
          <line x1="6" y1="6" x2="18" y2="18"></line>
        </svg>
      </button>
    </div>
    <div class="sg-chat-body" id="sg-chat-body"></div>
    <div class="sg-chat-input-area">
      <input type="text" class="sg-chat-input" id="sg-chat-input" placeholder="Ask about countertops..." autocomplete="off">
      <button class="sg-send-btn" id="sg-send-btn" aria-label="Send message">
        <svg xmlns="http://www.w3.org/2000/svg" width="22" height="22" viewBox="0 0 24 24" fill="#f9cb00" stroke="none">
          <path d="M2.01 21L23 12 2.01 3 2 10l15 2-15 2z"/>
        </svg>
      </button>
    </div>
  </div>
</div>

<script>
(function(){
  var WEBHOOK = 'https://www.voicenowcrm.com/api/webhook/agent/6913b021776947444de0638e/sales';
  var sessionId = 'sg_' + Date.now() + '_' + Math.random().toString(36).substr(2, 9);
  var isOpen = false;
  var btn = document.getElementById('sg-chat-button');
  var win = document.getElementById('sg-chat-window');
  var closeBtn = document.querySelector('.sg-chat-close');
  var body = document.getElementById('sg-chat-body');
  var input = document.getElementById('sg-chat-input');
  var sendBtn = document.getElementById('sg-send-btn');

  function toggle() {
    isOpen = !isOpen;
    btn.classList.toggle('active', isOpen);
    win.classList.toggle('active', isOpen);
    if (isOpen) {
      if (!body.hasChildNodes()) sendMessage('Hello');
      setTimeout(function() { input.focus(); }, 150);
    }
  }

  function addMessage(text, isUser) {
    var msg = document.createElement('div');
    msg.className = 'sg-message ' + (isUser ? 'user' : 'bot');
    msg.textContent = text;
    body.appendChild(msg);
    body.scrollTop = body.scrollHeight;
  }

  function showTyping(show) {
    var existing = document.getElementById('sg-typing-indicator');
    if (show && !existing) {
      var typing = document.createElement('div');
      typing.id = 'sg-typing-indicator';
      typing.className = 'sg-typing';
      typing.innerHTML = '<span></span><span></span><span></span>';
      body.appendChild(typing);
      body.scrollTop = body.scrollHeight;
    } else if (!show && existing) {
      existing.remove();
    }
  }

  function sendMessage(text) {
    if (text !== 'Hello') addMessage(text, true);
    showTyping(true);
    fetch(WEBHOOK, {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify({ message: text, sessionId: sessionId, page: window.location.pathname })
    })
    .then(function(res) {
      showTyping(false);
      if (res.ok) return res.json();
      throw new Error('Network error');
    })
    .then(function(data) {
      addMessage(data.response || data.message || 'Thanks! How can I help you today?', false);
    })
    .catch(function() {
      showTyping(false);
      addMessage('Thanks for reaching out! Call us at (602) 833-3189 for immediate assistance.', false);
    });
  }

  function handleSend() {
    var text = input.value.trim();
    if (text) { input.value = ''; sendMessage(text); }
  }

  btn.addEventListener('click', toggle);
  closeBtn.addEventListener('click', toggle);
  sendBtn.addEventListener('click', handleSend);
  input.addEventListener('keypress', function(e) { if (e.key === 'Enter') handleSend(); });
})();
</script>
